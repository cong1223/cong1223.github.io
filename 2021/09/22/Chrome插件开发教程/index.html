<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="å°èªå¿™"><meta name="copyright" content="å°èªå¿™"><meta name="generator" content="Hexo 5.3.0"><meta name="theme" content="hexo-theme-yun"><title>Chromeæ’ä»¶å¼€å‘æ•™ç¨‹ | èªå¿™çš„å°ç«™-Code &amp; Rock</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"cong1223.github.io","root":"/","title":"èªå¿™çš„å°ç«™","version":"1.4.0","mode":"auto","copycode":true,"page":{"isPost":true},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"appID":"FPFBIG0SN1","apiKey":"f75714621d5494f13edbe7a616932224","indexName":"hexo-blog","hits":{"per_page":8},"labels":{"input_placeholder":"æœç´¢æ–‡ç« ","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹ æœ¬æ–‡å…ˆä»‹ç»æ’ä»¶çš„å‡ ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œå†ä»é¡¹ç›®å®æˆ˜çš„è§’åº¦æ·±åˆ»è®°å¿†å®ƒã€‚  ç®€ä»‹è°·æ­Œæµè§ˆå™¨å³ä¸Šè§’çš„æ‰©å±•æ’ä»¶(Chrome Extension)å®é™…ä¸Šæ˜¯æ˜¯æ›´åº•å±‚çš„æµè§ˆå™¨åŠŸèƒ½æ‰©å±•ã€‚Chromeæ’ä»¶æ˜¯ä¸€ä¸ªç”¨WebæŠ€æœ¯å¼€å‘ã€ç”¨æ¥å¢å¼ºæµè§ˆå™¨åŠŸèƒ½çš„è½¯ä»¶ï¼Œå®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªç”±HTMLã€CSSã€JSã€å›¾ç‰‡ç­‰èµ„æºç»„æˆçš„ä¸€ä¸ª.crxåç¼€çš„å‹ç¼©åŒ…ã€‚ æ ¸å¿ƒä»‹ç»manifest.jsonè¿™æ˜¯ä¸€ä¸ªChrome">
<meta property="og:type" content="article">
<meta property="og:title" content="Chromeæ’ä»¶å¼€å‘æ•™ç¨‹">
<meta property="og:url" content="https://cong1223.github.io/2021/09/22/Chrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="èªå¿™çš„å°ç«™-Code &amp; Rock">
<meta property="og:description" content="Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹ æœ¬æ–‡å…ˆä»‹ç»æ’ä»¶çš„å‡ ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œå†ä»é¡¹ç›®å®æˆ˜çš„è§’åº¦æ·±åˆ»è®°å¿†å®ƒã€‚  ç®€ä»‹è°·æ­Œæµè§ˆå™¨å³ä¸Šè§’çš„æ‰©å±•æ’ä»¶(Chrome Extension)å®é™…ä¸Šæ˜¯æ˜¯æ›´åº•å±‚çš„æµè§ˆå™¨åŠŸèƒ½æ‰©å±•ã€‚Chromeæ’ä»¶æ˜¯ä¸€ä¸ªç”¨WebæŠ€æœ¯å¼€å‘ã€ç”¨æ¥å¢å¼ºæµè§ˆå™¨åŠŸèƒ½çš„è½¯ä»¶ï¼Œå®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªç”±HTMLã€CSSã€JSã€å›¾ç‰‡ç­‰èµ„æºç»„æˆçš„ä¸€ä¸ª.crxåç¼€çš„å‹ç¼©åŒ…ã€‚ æ ¸å¿ƒä»‹ç»manifest.jsonè¿™æ˜¯ä¸€ä¸ªChrome">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185743.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185752.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185800.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185814.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185814.png">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101604947-1619892598.gif">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101633728-1835819108.gif">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101651618-268310284.png">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101704775-1000780193.png">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101756868-1307680533.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185830.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185836.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185839.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185842.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185846.gif">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185850.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185855.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185858.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185903.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185914.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185920.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185920.png">
<meta property="article:published_time" content="2021-09-22T01:36:56.000Z">
<meta property="article:modified_time" content="2021-09-22T01:38:44.704Z">
<meta property="article:author" content="å°èªå¿™">
<meta property="article:tag" content="è°·æ­Œæµè§ˆå™¨æ’ä»¶">
<meta property="article:tag" content="extension">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185743.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="å°èªå¿™"><img width="96" loading="lazy" src="/images/ghostwang.jpeg" alt="å°èªå¿™"><span class="site-author-status" title="Looking for dawn.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">å°èªå¿™</a></div><a class="site-name" href="/about/site.html">èªå¿™çš„å°ç«™-Code &amp; Rock</a><sub class="site-subtitle">è®°å½•åˆ†äº«å‰ç«¯é¢†åŸŸæŠ€æœ¯åšæ–‡</sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">69</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">15</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">63</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://jq.qq.com/?_wv=1027&amp;k=g4dnBzs9" title="QQ ç¾¤ 94500464" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/cong1223" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/5861177611" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=436106908" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/94308826" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131133736.png" title="å¾®ä¿¡å…¬ä¼—å·" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:1215524451@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Chrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E7%9F%A5%E8%AF%86%E8%A6%81%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.0.1.</span> <span class="toc-text">ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.0.2.</span> <span class="toc-text">æ ¸å¿ƒä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#manifest-json"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">manifest.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#content-scripts"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">content-scripts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#background"><span class="toc-number">1.0.2.3.</span> <span class="toc-text">background</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#event-pages"><span class="toc-number">1.0.2.4.</span> <span class="toc-text">event-pages</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#popup"><span class="toc-number">1.0.2.5.</span> <span class="toc-text">popup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#injected-script"><span class="toc-number">1.0.2.6.</span> <span class="toc-text">injected-script</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#homepage-url"><span class="toc-number">1.0.2.7.</span> <span class="toc-text">homepage_url</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chrome%E6%8F%92%E4%BB%B6%E7%9A%848%E7%A7%8D%E5%B1%95%E7%A4%BA%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.0.3.</span> <span class="toc-text">Chromeæ’ä»¶çš„8ç§å±•ç¤ºå½¢å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#browserAction-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%B3%E4%B8%8A%E8%A7%92"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">browserAction(æµè§ˆå™¨å³ä¸Šè§’)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pageAction-%E5%9C%B0%E5%9D%80%E6%A0%8F%E5%8F%B3%E4%BE%A7"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">pageAction(åœ°å€æ å³ä¾§)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95"><span class="toc-number">1.0.3.3.</span> <span class="toc-text">å³é”®èœå•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#override-%E8%A6%86%E7%9B%96%E7%89%B9%E5%AE%9A%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.0.3.4.</span> <span class="toc-text">override(è¦†ç›–ç‰¹å®šé¡µé¢)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devtools-%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7"><span class="toc-number">1.0.3.5.</span> <span class="toc-text">devtools(å¼€å‘è€…å·¥å…·)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#option-%E9%80%89%E9%A1%B9%E9%A1%B5"><span class="toc-number">1.0.3.6.</span> <span class="toc-text">option(é€‰é¡¹é¡µ)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#omnibox"><span class="toc-number">1.0.3.7.</span> <span class="toc-text">omnibox</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%8C%E9%9D%A2%E9%80%9A%E7%9F%A5"><span class="toc-number">1.0.3.8.</span> <span class="toc-text">æ¡Œé¢é€šçŸ¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84JS%E5%AF%B9%E6%AF%94"><span class="toc-number">1.0.4.</span> <span class="toc-text">5ç§ç±»å‹çš„JSå¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E5%AF%B9%E6%AF%94"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">æƒé™å¯¹æ¯”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E6%96%B9%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-number">1.0.4.2.</span> <span class="toc-text">è°ƒè¯•æ–¹å¼å¯¹æ¯”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1"><span class="toc-number">1.0.5.</span> <span class="toc-text">æ¶ˆæ¯é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%92%E7%9B%B8%E9%80%9A%E4%BF%A1%E6%A6%82%E8%A7%88"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">äº’ç›¸é€šä¿¡æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.0.5.2.</span> <span class="toc-text">é€šä¿¡è¯¦ç»†ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-popup%E5%92%8Cbackground"><span class="toc-number">1.0.5.2.0.1.</span> <span class="toc-text">1. popupå’Œbackground</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-popup%E6%88%96%E8%80%85bg%E5%90%91content%E4%B8%BB%E5%8A%A8%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"><span class="toc-number">1.0.5.2.0.2.</span> <span class="toc-text">2.popupæˆ–è€…bgå‘contentä¸»åŠ¨å‘é€æ¶ˆæ¯</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-content-script%E4%B8%BB%E5%8A%A8%E5%8F%91%E6%B6%88%E6%81%AF%E7%BB%99%E5%90%8E%E5%8F%B0"><span class="toc-number">1.0.5.2.0.3.</span> <span class="toc-text">3. content-scriptä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-injected-script%E5%92%8Ccontent-script"><span class="toc-number">1.0.5.2.0.4.</span> <span class="toc-text">4. injected scriptå’Œcontent-script</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E8%BF%9E%E6%8E%A5%E5%92%8C%E7%9F%AD%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.0.5.3.</span> <span class="toc-text">é•¿è¿æ¥å’ŒçŸ­è¿æ¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E8%A1%A5%E5%85%85"><span class="toc-number">1.0.6.</span> <span class="toc-text">å…¶å®ƒè¡¥å……</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5%E6%88%96%E6%89%A7%E8%A1%8CJS"><span class="toc-number">1.0.6.1.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥æˆ–æ‰§è¡ŒJS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B3%A8%E5%85%A5CSS"><span class="toc-number">1.0.6.2.</span> <span class="toc-text">åŠ¨æ€æ³¨å…¥CSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3ID"><span class="toc-number">1.0.6.3.</span> <span class="toc-text">è·å–å½“å‰çª—å£ID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%A0%87%E7%AD%BE%E9%A1%B5ID"><span class="toc-number">1.0.6.4.</span> <span class="toc-text">è·å–å½“å‰æ ‡ç­¾é¡µID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8"><span class="toc-number">1.0.6.5.</span> <span class="toc-text">æœ¬åœ°å­˜å‚¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webRequest"><span class="toc-number">1.0.6.6.</span> <span class="toc-text">webRequest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#API%E6%80%BB%E7%BB%93"><span class="toc-number">1.0.6.7.</span> <span class="toc-text">APIæ€»ç»“</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98"><span class="toc-number">2.</span> <span class="toc-text">é¡¹ç›®å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-vue-cli-4-%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.0.1.</span> <span class="toc-text">åˆ›å»º vue cli 4 é¡¹ç›®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0-chrome-ext-%E6%8F%92%E4%BB%B6"><span class="toc-number">2.0.2.</span> <span class="toc-text">æ·»åŠ  chrome-ext æ’ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%AD%E9%87%8D%E8%BD%BD%E5%BC%80%E5%8F%91"><span class="toc-number">2.0.3.</span> <span class="toc-text">çƒ­é‡è½½å¼€å‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-UI-%E7%BB%84%E4%BB%B6"><span class="toc-number">2.0.4.</span> <span class="toc-text">ä½¿ç”¨ UI ç»„ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84-popup-%E7%95%8C%E9%9D%A2"><span class="toc-number">2.0.5.</span> <span class="toc-text">ç¼–å†™ä¸€ä¸ªç®€å•çš„ popup ç•Œé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E5%A5%BD%E7%8E%A9%E7%9A%84%E5%BE%85%E5%8F%91%E7%8E%B0%E2%80%A6"><span class="toc-number">2.0.6.</span> <span class="toc-text">æ›´å¤šå¥½ç©çš„å¾…å‘ç°â€¦</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://cong1223.github.io/2021/09/22/Chrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="å°èªå¿™"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="èªå¿™çš„å°ç«™-Code &amp; Rock"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Chromeæ’ä»¶å¼€å‘æ•™ç¨‹</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-09-22 09:36:56" itemprop="dateCreated datePublished" datetime="2021-09-22T09:36:56+08:00">2021-09-22</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">8.1k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">34m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/Chrome-extension/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Chrome extension</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">è°·æ­Œæµè§ˆå™¨æ’ä»¶</span></a><a class="tag" href="/tags/extension/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">extension</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹"><a href="#Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹" class="headerlink" title="Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹"></a>Chromeæ’ä»¶å¼€å‘çŸ¥è¯†è¦ç‚¹</h1><blockquote>
<p>æœ¬æ–‡å…ˆä»‹ç»æ’ä»¶çš„å‡ ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œå†ä»é¡¹ç›®å®æˆ˜çš„è§’åº¦æ·±åˆ»è®°å¿†å®ƒã€‚</p>
</blockquote>
<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>è°·æ­Œæµè§ˆå™¨å³ä¸Šè§’çš„æ‰©å±•æ’ä»¶(<code>Chrome Extension</code>)å®é™…ä¸Šæ˜¯æ˜¯æ›´åº•å±‚çš„æµè§ˆå™¨åŠŸèƒ½æ‰©å±•ã€‚<code>Chrome</code>æ’ä»¶æ˜¯ä¸€ä¸ªç”¨WebæŠ€æœ¯å¼€å‘ã€ç”¨æ¥å¢å¼ºæµè§ˆå™¨åŠŸèƒ½çš„è½¯ä»¶ï¼Œå®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªç”±HTMLã€CSSã€JSã€å›¾ç‰‡ç­‰èµ„æºç»„æˆçš„ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/crx">.crx</a>åç¼€çš„å‹ç¼©åŒ…ã€‚</p>
<h3 id="æ ¸å¿ƒä»‹ç»"><a href="#æ ¸å¿ƒä»‹ç»" class="headerlink" title="æ ¸å¿ƒä»‹ç»"></a>æ ¸å¿ƒä»‹ç»</h3><h4 id="manifest-json"><a href="#manifest-json" class="headerlink" title="manifest.json"></a>manifest.json</h4><p>è¿™æ˜¯ä¸€ä¸ªChromeæ’ä»¶æœ€é‡è¦ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„æ–‡ä»¶ï¼Œç”¨æ¥é…ç½®æ‰€æœ‰å’Œæ’ä»¶ç›¸å…³çš„é…ç½®ï¼Œå¿…é¡»æ”¾åœ¨æ ¹ç›®å½•ã€‚å…¶ä¸­ï¼Œ<code>manifest_version</code>ã€<code>name</code>ã€<code>version</code>3ä¸ªæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œ<code>description</code>å’Œ<code>icons</code>æ˜¯æ¨èçš„ã€‚</p>
<p>ä¸‹é¢ç»™å‡ºçš„æ˜¯ä¸€äº›å¸¸è§çš„é…ç½®é¡¹ï¼Œå‡æœ‰ä¸­æ–‡æ³¨é‡Šï¼Œå®Œæ•´çš„é…ç½®æ–‡æ¡£è¯·æˆ³<a target="_blank" rel="noopener" href="http://chrome.cenchy.com/manifest.html">è¿™é‡Œ</a>ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// æ¸…å•æ–‡ä»¶çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªå¿…é¡»å†™ï¼Œè€Œä¸”å¿…é¡»æ˜¯2</span></span><br><span class="line">	<span class="attr">&quot;manifest_version&quot;</span>: <span class="number">2</span>,</span><br><span class="line">	<span class="comment">// æ’ä»¶çš„åç§°</span></span><br><span class="line">	<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;demo&quot;</span>,</span><br><span class="line">	<span class="comment">// æ’ä»¶çš„ç‰ˆæœ¬</span></span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">	<span class="comment">// æ’ä»¶æè¿°</span></span><br><span class="line">	<span class="attr">&quot;description&quot;</span>: <span class="string">&quot;ç®€å•çš„Chromeæ‰©å±•demo&quot;</span>,</span><br><span class="line">	<span class="comment">// å›¾æ ‡ï¼Œä¸€èˆ¬å·æ‡’å…¨éƒ¨ç”¨ä¸€ä¸ªå°ºå¯¸çš„ä¹Ÿæ²¡é—®é¢˜</span></span><br><span class="line">	<span class="attr">&quot;icons&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">&quot;16&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;48&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;128&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">// ä¼šä¸€ç›´å¸¸é©»çš„åå°JSæˆ–åå°é¡µé¢</span></span><br><span class="line">	<span class="attr">&quot;background&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 2ç§æŒ‡å®šæ–¹å¼ï¼Œå¦‚æœæŒ‡å®šJSï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªèƒŒæ™¯é¡µ</span></span><br><span class="line">		<span class="attr">&quot;page&quot;</span>: <span class="string">&quot;background.html&quot;</span></span><br><span class="line">		<span class="comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">// æµè§ˆå™¨å³ä¸Šè§’å›¾æ ‡è®¾ç½®ï¼Œbrowser_actionã€page_actionã€appå¿…é¡»ä¸‰é€‰ä¸€</span></span><br><span class="line">	<span class="attr">&quot;browser_action&quot;</span>: </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">		<span class="comment">// å›¾æ ‡æ‚¬åœæ—¶çš„æ ‡é¢˜ï¼Œå¯é€‰</span></span><br><span class="line">		<span class="attr">&quot;default_title&quot;</span>: <span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹Chromeæ’ä»¶&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">// å½“æŸäº›ç‰¹å®šé¡µé¢æ‰“å¼€æ‰æ˜¾ç¤ºçš„å›¾æ ‡</span></span><br><span class="line">	<span class="comment">/*&quot;page_action&quot;:</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		&quot;default_icon&quot;: &quot;img/icon.png&quot;,</span></span><br><span class="line"><span class="comment">		&quot;default_title&quot;: &quot;æˆ‘æ˜¯pageAction&quot;,</span></span><br><span class="line"><span class="comment">		&quot;default_popup&quot;: &quot;popup.html&quot;</span></span><br><span class="line"><span class="comment">	&#125;,*/</span></span><br><span class="line">	<span class="comment">// éœ€è¦ç›´æ¥æ³¨å…¥é¡µé¢çš„JS</span></span><br><span class="line">	<span class="attr">&quot;content_scripts&quot;</span>: </span><br><span class="line">	[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span></span><br><span class="line">			<span class="comment">// &quot;&lt;all_urls&gt;&quot; è¡¨ç¤ºåŒ¹é…æ‰€æœ‰åœ°å€</span></span><br><span class="line">			<span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>],</span><br><span class="line">			<span class="comment">// å¤šä¸ªJSæŒ‰é¡ºåºæ³¨å…¥</span></span><br><span class="line">			<span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/jquery-1.8.3.js&quot;</span>, <span class="string">&quot;js/content-script.js&quot;</span>],</span><br><span class="line">			<span class="comment">// JSçš„æ³¨å…¥å¯ä»¥éšä¾¿ä¸€ç‚¹ï¼Œä½†æ˜¯CSSçš„æ³¨æ„å°±è¦åƒä¸‡å°å¿ƒäº†ï¼Œå› ä¸ºä¸€ä¸å°å¿ƒå°±å¯èƒ½å½±å“å…¨å±€æ ·å¼</span></span><br><span class="line">			<span class="attr">&quot;css&quot;</span>: [<span class="string">&quot;css/custom.css&quot;</span>],</span><br><span class="line">			<span class="comment">// ä»£ç æ³¨å…¥çš„æ—¶é—´ï¼Œå¯é€‰å€¼ï¼š &quot;document_start&quot;, &quot;document_end&quot;, or &quot;document_idle&quot;ï¼Œæœ€åä¸€ä¸ªè¡¨ç¤ºé¡µé¢ç©ºé—²æ—¶ï¼Œé»˜è®¤document_idle</span></span><br><span class="line">			<span class="attr">&quot;run_at&quot;</span>: <span class="string">&quot;document_start&quot;</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="comment">// è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†æ¼”ç¤ºcontent-scriptå¯ä»¥é…ç½®å¤šä¸ªè§„åˆ™</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;*://*/*.png&quot;</span>, <span class="string">&quot;*://*/*.jpg&quot;</span>, <span class="string">&quot;*://*/*.gif&quot;</span>, <span class="string">&quot;*://*/*.bmp&quot;</span>],</span><br><span class="line">			<span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/show-image-content-size.js&quot;</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	],</span><br><span class="line">	<span class="comment">// æƒé™ç”³è¯·</span></span><br><span class="line">	<span class="attr">&quot;permissions&quot;</span>:</span><br><span class="line">	[</span><br><span class="line">		<span class="string">&quot;contextMenus&quot;</span>, <span class="comment">// å³é”®èœå•</span></span><br><span class="line">		<span class="string">&quot;tabs&quot;</span>, <span class="comment">// æ ‡ç­¾</span></span><br><span class="line">		<span class="string">&quot;notifications&quot;</span>, <span class="comment">// é€šçŸ¥</span></span><br><span class="line">		<span class="string">&quot;webRequest&quot;</span>, <span class="comment">// webè¯·æ±‚</span></span><br><span class="line">		<span class="string">&quot;webRequestBlocking&quot;</span>,</span><br><span class="line">		<span class="string">&quot;storage&quot;</span>, <span class="comment">// æ’ä»¶æœ¬åœ°å­˜å‚¨</span></span><br><span class="line">		<span class="string">&quot;http://*/*&quot;</span>, <span class="comment">// å¯ä»¥é€šè¿‡executeScriptæˆ–è€…insertCSSè®¿é—®çš„ç½‘ç«™</span></span><br><span class="line">		<span class="string">&quot;https://*/*&quot;</span> <span class="comment">// å¯ä»¥é€šè¿‡executeScriptæˆ–è€…insertCSSè®¿é—®çš„ç½‘ç«™</span></span><br><span class="line">	],</span><br><span class="line">	<span class="comment">// æ™®é€šé¡µé¢èƒ½å¤Ÿç›´æ¥è®¿é—®çš„æ’ä»¶èµ„æºåˆ—è¡¨ï¼Œå¦‚æœä¸è®¾ç½®æ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„</span></span><br><span class="line">	<span class="attr">&quot;web_accessible_resources&quot;</span>: [<span class="string">&quot;js/inject.js&quot;</span>],</span><br><span class="line">	<span class="comment">// æ’ä»¶ä¸»é¡µï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œä¸è¦æµªè´¹äº†è¿™ä¸ªå…è´¹å¹¿å‘Šä½</span></span><br><span class="line">	<span class="attr">&quot;homepage_url&quot;</span>: <span class="string">&quot;https://www.baidu.com&quot;</span>,</span><br><span class="line">	<span class="comment">// è¦†ç›–æµè§ˆå™¨é»˜è®¤é¡µé¢</span></span><br><span class="line">	<span class="attr">&quot;chrome_url_overrides&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// è¦†ç›–æµè§ˆå™¨é»˜è®¤çš„æ–°æ ‡ç­¾é¡µ</span></span><br><span class="line">		<span class="attr">&quot;newtab&quot;</span>: <span class="string">&quot;newtab.html&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">// Chrome40ä»¥å‰çš„æ’ä»¶é…ç½®é¡µå†™æ³•</span></span><br><span class="line">	<span class="attr">&quot;options_page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">	<span class="comment">// Chrome40ä»¥åçš„æ’ä»¶é…ç½®é¡µå†™æ³•ï¼Œå¦‚æœ2ä¸ªéƒ½å†™ï¼Œæ–°ç‰ˆChromeåªè®¤åé¢è¿™ä¸€ä¸ª</span></span><br><span class="line">	<span class="attr">&quot;options_ui&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">&quot;page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">		<span class="comment">// æ·»åŠ ä¸€äº›é»˜è®¤çš„æ ·å¼ï¼Œæ¨èä½¿ç”¨</span></span><br><span class="line">		<span class="attr">&quot;chrome_style&quot;</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">// å‘åœ°å€æ æ³¨å†Œä¸€ä¸ªå…³é”®å­—ä»¥æä¾›æœç´¢å»ºè®®ï¼Œåªèƒ½è®¾ç½®ä¸€ä¸ªå…³é”®å­—</span></span><br><span class="line">	<span class="attr">&quot;omnibox&quot;</span>: &#123; <span class="attr">&quot;keyword&quot;</span> : <span class="string">&quot;go&quot;</span> &#125;,</span><br><span class="line">	<span class="comment">// é»˜è®¤è¯­è¨€</span></span><br><span class="line">	<span class="attr">&quot;default_locale&quot;</span>: <span class="string">&quot;zh_CN&quot;</span>,</span><br><span class="line">	<span class="comment">// devtoolsé¡µé¢å…¥å£ï¼Œæ³¨æ„åªèƒ½æŒ‡å‘ä¸€ä¸ªHTMLæ–‡ä»¶ï¼Œä¸èƒ½æ˜¯JSæ–‡ä»¶</span></span><br><span class="line">	<span class="attr">&quot;devtools_page&quot;</span>: <span class="string">&quot;devtools.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="content-scripts"><a href="#content-scripts" class="headerlink" title="content-scripts"></a>content-scripts</h4><p>æ‰€è°“<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/content_scripts">content-scripts</a>ï¼Œå…¶å®å°±æ˜¯Chromeæ’ä»¶ä¸­å‘é¡µé¢æ³¨å…¥è„šæœ¬çš„ä¸€ç§å½¢å¼ï¼ˆè™½ç„¶åä¸ºscriptï¼Œå…¶å®è¿˜å¯ä»¥åŒ…æ‹¬cssçš„ï¼‰ï¼Œå€ŸåŠ©<code>content-scripts</code>æˆ‘ä»¬å¯ä»¥å®ç°é€šè¿‡é…ç½®çš„æ–¹å¼è½»æ¾å‘æŒ‡å®šé¡µé¢æ³¨å…¥JSå’ŒCSSï¼ˆå¦‚æœéœ€è¦åŠ¨æ€æ³¨å…¥ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–‡ï¼‰ï¼Œæœ€å¸¸è§çš„æ¯”å¦‚ï¼šå¹¿å‘Šå±è”½ã€é¡µé¢CSSå®šåˆ¶ï¼Œç­‰ç­‰ã€‚</p>
<p>ç¤ºä¾‹é…ç½®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// éœ€è¦ç›´æ¥æ³¨å…¥é¡µé¢çš„JS</span></span><br><span class="line">	<span class="attr">&quot;content_scripts&quot;</span>: </span><br><span class="line">	[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span></span><br><span class="line">			<span class="comment">// &quot;&lt;all_urls&gt;&quot; è¡¨ç¤ºåŒ¹é…æ‰€æœ‰åœ°å€</span></span><br><span class="line">			<span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>],</span><br><span class="line">			<span class="comment">// å¤šä¸ªJSæŒ‰é¡ºåºæ³¨å…¥</span></span><br><span class="line">			<span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/jquery-1.8.3.js&quot;</span>, <span class="string">&quot;js/content-script.js&quot;</span>],</span><br><span class="line">			<span class="comment">// JSçš„æ³¨å…¥å¯ä»¥éšä¾¿ä¸€ç‚¹ï¼Œä½†æ˜¯CSSçš„æ³¨æ„å°±è¦åƒä¸‡å°å¿ƒäº†ï¼Œå› ä¸ºä¸€ä¸å°å¿ƒå°±å¯èƒ½å½±å“å…¨å±€æ ·å¼</span></span><br><span class="line">			<span class="attr">&quot;css&quot;</span>: [<span class="string">&quot;css/custom.css&quot;</span>],</span><br><span class="line">			<span class="comment">// ä»£ç æ³¨å…¥çš„æ—¶é—´ï¼Œå¯é€‰å€¼ï¼š &quot;document_start&quot;, &quot;document_end&quot;, or &quot;document_idle&quot;ï¼Œæœ€åä¸€ä¸ªè¡¨ç¤ºé¡µé¢ç©ºé—²æ—¶ï¼Œé»˜è®¤document_idle</span></span><br><span class="line">			<span class="attr">&quot;run_at&quot;</span>: <span class="string">&quot;document_start&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">	],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰ä¸»åŠ¨æŒ‡å®š<code>run_at</code>ä¸º<code>document_start</code>ï¼ˆé»˜è®¤ä¸º<code>document_idle</code>ï¼‰ï¼Œä¸‹é¢è¿™ç§ä»£ç æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;æˆ‘è¢«æ‰§è¡Œäº†ï¼&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>content-scripts</code>å’ŒåŸå§‹é¡µé¢å…±äº«DOMï¼Œä½†æ˜¯ä¸å…±äº«JSï¼Œå¦‚è¦è®¿é—®é¡µé¢JSï¼ˆä¾‹å¦‚æŸä¸ªJSå˜é‡ï¼‰ï¼Œåªèƒ½é€šè¿‡<code>injected js</code>æ¥å®ç°ã€‚<code>content-scripts</code>ä¸èƒ½è®¿é—®ç»å¤§éƒ¨åˆ†<code>chrome.xxx.api</code>ï¼Œé™¤äº†ä¸‹é¢è¿™4ç§ï¼š</p>
<ul>
<li>chrome.extension(getURL , inIncognitoContext , lastError , onRequest , sendRequest)</li>
<li>chrome.i18n</li>
<li>chrome.runtime(connect , getManifest , getURL , id , onConnect , onMessage , sendMessage)</li>
<li>chrome.storage</li>
</ul>
<p>å…¶å®çœ‹åˆ°è¿™é‡Œä¸è¦æ‚²è§‚ï¼Œè¿™äº›APIç»å¤§éƒ¨åˆ†æ—¶å€™éƒ½å¤Ÿç”¨äº†ï¼Œéè¦è°ƒç”¨å…¶å®ƒAPIçš„è¯ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡é€šä¿¡æ¥å®ç°è®©backgroundæ¥å¸®ä½ è°ƒç”¨ï¼ˆå…³äºé€šä¿¡ï¼Œåæ–‡æœ‰è¯¦ç»†ä»‹ç»ï¼‰ã€‚</p>
<h4 id="background"><a href="#background" class="headerlink" title="background"></a>background</h4><p>åå°ï¼ˆå§‘ä¸”è¿™ä¹ˆç¿»è¯‘å§ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¸¸é©»çš„é¡µé¢ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ’ä»¶ä¸­æ‰€æœ‰ç±»å‹é¡µé¢ä¸­æœ€é•¿çš„ï¼Œå®ƒéšç€æµè§ˆå™¨çš„æ‰“å¼€è€Œæ‰“å¼€ï¼Œéšç€æµè§ˆå™¨çš„å…³é—­è€Œå…³é—­ï¼Œæ‰€ä»¥é€šå¸¸æŠŠéœ€è¦ä¸€ç›´è¿è¡Œçš„ã€å¯åŠ¨å°±è¿è¡Œçš„ã€å…¨å±€çš„ä»£ç æ”¾åœ¨backgroundé‡Œé¢ã€‚</p>
<p>backgroundçš„æƒé™éå¸¸é«˜ï¼Œå‡ ä¹å¯ä»¥è°ƒç”¨æ‰€æœ‰çš„Chromeæ‰©å±•APIï¼ˆé™¤äº†devtoolsï¼‰ï¼Œè€Œä¸”å®ƒå¯ä»¥æ— é™åˆ¶è·¨åŸŸï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è·¨åŸŸè®¿é—®ä»»ä½•ç½‘ç«™è€Œæ— éœ€è¦æ±‚å¯¹æ–¹è®¾ç½®<code>CORS</code>ã€‚</p>
<blockquote>
<p>ç»è¿‡æµ‹è¯•ï¼Œå…¶å®ä¸æ­¢æ˜¯backgroundï¼Œæ‰€æœ‰çš„ç›´æ¥é€šè¿‡<code>chrome-extension://id/xx.html</code>è¿™ç§æ–¹å¼æ‰“å¼€çš„ç½‘é¡µéƒ½å¯ä»¥æ— é™åˆ¶è·¨åŸŸã€‚</p>
</blockquote>
<p>é…ç½®ä¸­ï¼Œ<code>background</code>å¯ä»¥é€šè¿‡<code>page</code>æŒ‡å®šä¸€å¼ ç½‘é¡µï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>scripts</code>ç›´æ¥æŒ‡å®šä¸€ä¸ªJSï¼ŒChromeä¼šè‡ªåŠ¨ä¸ºè¿™ä¸ªJSç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„ç½‘é¡µï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// ä¼šä¸€ç›´å¸¸é©»çš„åå°JSæˆ–åå°é¡µé¢</span></span><br><span class="line">	<span class="attr">&quot;background&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 2ç§æŒ‡å®šæ–¹å¼ï¼Œå¦‚æœæŒ‡å®šJSï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªèƒŒæ™¯é¡µ</span></span><br><span class="line">		<span class="attr">&quot;page&quot;</span>: <span class="string">&quot;background.html&quot;</span></span><br><span class="line">		<span class="comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span></span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼Œè™½ç„¶ä½ å¯ä»¥é€šè¿‡<code>chrome-extension://xxx/background.html</code>ç›´æ¥æ‰“å¼€åå°é¡µï¼Œä½†æ˜¯ä½ æ‰“å¼€çš„åå°é¡µå’ŒçœŸæ­£ä¸€ç›´åœ¨åå°è¿è¡Œçš„é‚£ä¸ªé¡µé¢ä¸æ˜¯åŒä¸€ä¸ªï¼Œæ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥æ‰“å¼€æ— æ•°ä¸ª<code>background.html</code>ï¼Œä½†æ˜¯çœŸæ­£åœ¨åå°å¸¸é©»çš„åªæœ‰ä¸€ä¸ªï¼Œè€Œä¸”è¿™ä¸ªä½ æ°¸è¿œçœ‹ä¸åˆ°å®ƒçš„ç•Œé¢ï¼Œåªèƒ½è°ƒè¯•å®ƒçš„ä»£ç ã€‚</p>
<h4 id="event-pages"><a href="#event-pages" class="headerlink" title="event-pages"></a>event-pages</h4><p>è¿™é‡Œé¡ºå¸¦ä»‹ç»ä¸€ä¸‹<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/event_pages">event-pages</a>ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿé‰´äºbackgroundç”Ÿå‘½å‘¨æœŸå¤ªé•¿ï¼Œé•¿æ—¶é—´æŒ‚è½½åå°å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥Googleåˆå¼„ä¸€ä¸ª<code>event-pages</code>ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸Šï¼Œå®ƒä¸backgroundçš„å”¯ä¸€åŒºåˆ«å°±æ˜¯å¤šäº†ä¸€ä¸ª<code>persistent</code>å‚æ•°ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;background&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">&quot;scripts&quot;</span>: [<span class="string">&quot;event-page.js&quot;</span>],</span><br><span class="line">		<span class="attr">&quot;persistent&quot;</span>: <span class="literal">false</span></span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ï¼šåœ¨è¢«éœ€è¦æ—¶åŠ è½½ï¼Œåœ¨ç©ºé—²æ—¶è¢«å…³é—­ï¼Œä»€ä¹ˆå«è¢«éœ€è¦æ—¶å‘¢ï¼Ÿæ¯”å¦‚ç¬¬ä¸€æ¬¡å®‰è£…ã€æ’ä»¶æ›´æ–°ã€æœ‰content-scriptå‘å®ƒå‘é€æ¶ˆæ¯ï¼Œç­‰ç­‰ã€‚</p>
<p>é™¤äº†é…ç½®æ–‡ä»¶çš„å˜åŒ–ï¼Œä»£ç ä¸Šä¹Ÿæœ‰ä¸€äº›ç»†å¾®å˜åŒ–ï¼Œä¸ªäººè¿™ä¸ªç®€å•äº†è§£ä¸€ä¸‹å°±è¡Œäº†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹backgroundä¹Ÿä¸ä¼šå¾ˆæ¶ˆè€—æ€§èƒ½çš„ã€‚</p>
<h4 id="popup"><a href="#popup" class="headerlink" title="popup"></a>popup</h4><p><code>popup</code>æ˜¯ç‚¹å‡»<code>browser_action</code>æˆ–è€…<code>page_action</code>å›¾æ ‡æ—¶æ‰“å¼€çš„ä¸€ä¸ªå°çª—å£ç½‘é¡µï¼Œç„¦ç‚¹ç¦»å¼€ç½‘é¡µå°±ç«‹å³å…³é—­ï¼Œä¸€èˆ¬ç”¨æ¥åšä¸€äº›ä¸´æ—¶æ€§çš„äº¤äº’ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185743.png" alt="åšå®¢å›­ç½‘æ‘˜æ’ä»¶popupæ•ˆæœ" loading="lazy"></p>
<p><code>popup</code>å¯ä»¥åŒ…å«ä»»æ„ä½ æƒ³è¦çš„HTMLå†…å®¹ï¼Œå¹¶ä¸”ä¼šè‡ªé€‚åº”å¤§å°ã€‚å¯ä»¥é€šè¿‡<code>default_popup</code>å­—æ®µæ¥æŒ‡å®špopupé¡µé¢ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨<code>setPopup()</code>æ–¹æ³•ã€‚</p>
<p>é…ç½®æ–¹å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;browser_action&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">		<span class="comment">// å›¾æ ‡æ‚¬åœæ—¶çš„æ ‡é¢˜ï¼Œå¯é€‰</span></span><br><span class="line">		<span class="string">&quot;default_title&quot;</span>: <span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹Chromeæ’ä»¶&quot;</span>,</span><br><span class="line">		<span class="string">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185752.png" alt="img" loading="lazy"></p>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œç”±äºå•å‡»å›¾æ ‡æ‰“å¼€popupï¼Œç„¦ç‚¹ç¦»å¼€åˆç«‹å³å…³é—­ï¼Œæ‰€ä»¥popupé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸä¸€èˆ¬å¾ˆçŸ­ï¼Œéœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ä»£ç åƒä¸‡ä¸è¦å†™åœ¨popupé‡Œé¢ã€‚</p>
<p>åœ¨æƒé™ä¸Šï¼Œå®ƒå’Œbackgroundéå¸¸ç±»ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´æœ€å¤§çš„ä¸åŒæ˜¯ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒï¼Œpopupä¸­å¯ä»¥ç›´æ¥é€šè¿‡<code>chrome.extension.getBackgroundPage()</code>è·å–backgroundçš„windowå¯¹è±¡ã€‚</p>
<h4 id="injected-script"><a href="#injected-script" class="headerlink" title="injected-script"></a>injected-script</h4><p>è¿™é‡Œçš„<code>injected-script</code>æ˜¯æˆ‘ç»™å®ƒå–çš„ï¼ŒæŒ‡çš„æ˜¯é€šè¿‡DOMæ“ä½œçš„æ–¹å¼å‘é¡µé¢æ³¨å…¥çš„ä¸€ç§JSã€‚ä¸ºä»€ä¹ˆè¦æŠŠè¿™ç§JSå•ç‹¬æ‹¿å‡ºæ¥è®¨è®ºå‘¢ï¼Ÿåˆæˆ–è€…è¯´ä¸ºä»€ä¹ˆéœ€è¦é€šè¿‡è¿™ç§æ–¹å¼æ³¨å…¥JSå‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸º<code>content-script</code>æœ‰ä¸€ä¸ªå¾ˆå¤§çš„â€œç¼ºé™·â€ï¼Œä¹Ÿå°±æ˜¯æ— æ³•è®¿é—®é¡µé¢ä¸­çš„JSï¼Œè™½ç„¶å®ƒå¯ä»¥æ“ä½œDOMï¼Œä½†æ˜¯DOMå´ä¸èƒ½è°ƒç”¨å®ƒï¼Œä¹Ÿå°±æ˜¯æ— æ³•åœ¨DOMä¸­é€šè¿‡ç»‘å®šäº‹ä»¶çš„æ–¹å¼è°ƒç”¨<code>content-script</code>ä¸­çš„ä»£ç ï¼ˆåŒ…æ‹¬ç›´æ¥å†™<code>onclick</code>å’Œ<code>addEventListener</code>2ç§æ–¹å¼éƒ½ä¸è¡Œï¼‰ï¼Œä½†æ˜¯ï¼Œâ€œåœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€ä¸ªæŒ‰é’®å¹¶è°ƒç”¨æ’ä»¶çš„æ‰©å±•APIâ€æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®è¿™å°±æ˜¯æœ¬å°èŠ‚è¦è®²çš„ã€‚</p>
<p>åœ¨<code>content-script</code>ä¸­é€šè¿‡DOMæ–¹å¼å‘é¡µé¢æ³¨å…¥<code>inject-script</code>ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘é¡µé¢æ³¨å…¥JS</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">injectCustomJs</span>(<span class="params">jsPath</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	jsPath = jsPath || <span class="string">&#x27;js/inject.js&#x27;</span>;</span><br><span class="line">	<span class="keyword">var</span> temp = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">	temp.setAttribute(<span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;text/javascript&#x27;</span>);</span><br><span class="line">	<span class="comment">// è·å¾—çš„åœ°å€ç±»ä¼¼ï¼šchrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js</span></span><br><span class="line">	temp.src = chrome.extension.getURL(jsPath);</span><br><span class="line">	temp.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">// æ”¾åœ¨é¡µé¢ä¸å¥½çœ‹ï¼Œæ‰§è¡Œå®Œåç§»é™¤æ‰</span></span><br><span class="line">		<span class="built_in">this</span>.parentNode.removeChild(<span class="built_in">this</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">document</span>.head.appendChild(temp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ ä»¥ä¸ºè¿™æ ·å°±è¡Œäº†ï¼Ÿæ‰§è¡Œä¸€ä¸‹ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Denying load of chrome-extension://efbllncjkjiijkppagepehoekjojdclc/js/inject.js. Resources must be listed in the web_accessible_resources manifest key in order to be loaded by pages outside the extension.</span><br></pre></td></tr></table></figure>
<p>æ„æ€å°±æ˜¯ä½ æƒ³è¦åœ¨webä¸­ç›´æ¥è®¿é—®æ’ä»¶ä¸­çš„èµ„æºçš„è¯å¿…é¡»æ˜¾ç¤ºå£°æ˜æ‰è¡Œï¼Œé…ç½®æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// æ™®é€šé¡µé¢èƒ½å¤Ÿç›´æ¥è®¿é—®çš„æ’ä»¶èµ„æºåˆ—è¡¨ï¼Œå¦‚æœä¸è®¾ç½®æ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„</span></span><br><span class="line">	<span class="string">&quot;web_accessible_resources&quot;</span>: [<span class="string">&quot;js/inject.js&quot;</span>],</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è‡³äº<code>inject-script</code>å¦‚ä½•è°ƒç”¨<code>content-script</code>ä¸­çš„ä»£ç ï¼Œåé¢æˆ‘ä¼šåœ¨ä¸“é—¨çš„ä¸€ä¸ªæ¶ˆæ¯é€šä¿¡ç« èŠ‚è¯¦ç»†ä»‹ç»ã€‚</p>
<h4 id="homepage-url"><a href="#homepage-url" class="headerlink" title="homepage_url"></a>homepage_url</h4><p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185800.png" alt="img" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185814.png" alt="img" loading="lazy"></p>
<h3 id="Chromeæ’ä»¶çš„8ç§å±•ç¤ºå½¢å¼"><a href="#Chromeæ’ä»¶çš„8ç§å±•ç¤ºå½¢å¼" class="headerlink" title="Chromeæ’ä»¶çš„8ç§å±•ç¤ºå½¢å¼"></a>Chromeæ’ä»¶çš„8ç§å±•ç¤ºå½¢å¼</h3><h4 id="browserAction-æµè§ˆå™¨å³ä¸Šè§’"><a href="#browserAction-æµè§ˆå™¨å³ä¸Šè§’" class="headerlink" title="browserAction(æµè§ˆå™¨å³ä¸Šè§’)"></a>browserAction(æµè§ˆå™¨å³ä¸Šè§’)</h4><p>é€šè¿‡é…ç½®<code>browser_action</code>å¯ä»¥åœ¨æµè§ˆå™¨çš„å³ä¸Šè§’å¢åŠ ä¸€ä¸ªå›¾æ ‡ï¼Œä¸€ä¸ª<code>browser_action</code>å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªå›¾æ ‡ï¼Œä¸€ä¸ª<code>tooltip</code>ï¼Œä¸€ä¸ª<code>badge</code>å’Œä¸€ä¸ª<code>popup</code>ã€‚</p>
<p>ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;browser_action&quot;:</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;default_title&quot;</span>: <span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹Chromeæ’ä»¶&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="pageAction-åœ°å€æ å³ä¾§"><a href="#pageAction-åœ°å€æ å³ä¾§" class="headerlink" title="pageAction(åœ°å€æ å³ä¾§)"></a>pageAction(åœ°å€æ å³ä¾§)</h4><p>æ‰€è°“<code>pageAction</code>ï¼ŒæŒ‡çš„æ˜¯åªæœ‰å½“æŸäº›ç‰¹å®šé¡µé¢æ‰“å¼€æ‰æ˜¾ç¤ºçš„å›¾æ ‡ï¼Œå®ƒå’Œ<code>browserAction</code>æœ€å¤§çš„åŒºåˆ«æ˜¯ä¸€ä¸ªå§‹ç»ˆéƒ½æ˜¾ç¤ºï¼Œä¸€ä¸ªåªåœ¨ç‰¹å®šæƒ…å†µæ‰æ˜¾ç¤ºã€‚</p>
<p>éœ€è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯æ—©äº›ç‰ˆæœ¬çš„Chromeæ˜¯å°†pageActionæ”¾åœ¨åœ°å€æ çš„æœ€å³è¾¹ï¼Œå·¦é”®å•å‡»å¼¹å‡ºpopupï¼Œå³é”®å•å‡»åˆ™å¼¹å‡ºç›¸å…³é»˜è®¤çš„é€‰é¡¹èœå•ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185814.png" alt="img" loading="lazy"></p>
<p>è€Œæ–°ç‰ˆçš„Chromeæ›´æ”¹äº†è¿™ä¸€ç­–ç•¥ï¼ŒpageActionå’Œæ™®é€šçš„browserActionä¸€æ ·ä¹Ÿæ˜¯æ”¾åœ¨æµè§ˆå™¨å³ä¸Šè§’ï¼Œåªä¸è¿‡æ²¡æœ‰ç‚¹äº®æ—¶æ˜¯ç°è‰²çš„ï¼Œç‚¹äº®äº†æ‰æ˜¯å½©è‰²çš„ï¼Œç°è‰²æ—¶æ— è®ºå·¦é”®è¿˜æ˜¯å³é”®å•å‡»éƒ½æ˜¯å¼¹å‡ºé€‰é¡¹ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101604947-1619892598.gif" alt="img" loading="lazy"></p>
<blockquote>
<p>å…·ä½“æ˜¯ä»å“ªä¸€ç‰ˆæœ¬å¼€å§‹æ”¹çš„æ²¡å»ä»”ç»†è€ƒç©¶ï¼Œåæ­£çŸ¥é“v50.0çš„æ—¶å€™è¿˜æ˜¯å‰è€…ï¼Œv58.0çš„æ—¶å€™å·²æ”¹ä¸ºåè€…ã€‚</p>
</blockquote>
<p>è°ƒæ•´ä¹‹åçš„<code>pageAction</code>æˆ‘ä»¬å¯ä»¥ç®€å•åœ°æŠŠå®ƒçœ‹æˆæ˜¯å¯ä»¥ç½®ç°çš„<code>browserAction</code>ã€‚</p>
<ul>
<li>chrome.pageAction.show(tabId) æ˜¾ç¤ºå›¾æ ‡ï¼›</li>
<li>chrome.pageAction.hide(tabId) éšè—å›¾æ ‡ï¼›</li>
</ul>
<p>ç¤ºä¾‹(åªæœ‰æ‰“å¼€ç™¾åº¦æ‰æ˜¾ç¤ºå›¾æ ‡)ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// manifest.json</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;page_action&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">		<span class="string">&quot;default_title&quot;</span>: <span class="string">&quot;æˆ‘æ˜¯pageAction&quot;</span>,</span><br><span class="line">		<span class="string">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">&quot;permissions&quot;</span>: [<span class="string">&quot;declarativeContent&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// background.js</span></span><br><span class="line">chrome.runtime.onInstalled.addListener(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	chrome.declarativeContent.onPageChanged.removeRules(<span class="literal">undefined</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		chrome.declarativeContent.onPageChanged.addRules([</span><br><span class="line">			&#123;</span><br><span class="line">				conditions: [</span><br><span class="line">					<span class="comment">// åªæœ‰æ‰“å¼€ç™¾åº¦æ‰æ˜¾ç¤ºpageAction</span></span><br><span class="line">					<span class="keyword">new</span> chrome.declarativeContent.PageStateMatcher(&#123;<span class="attr">pageUrl</span>: &#123;<span class="attr">urlContains</span>: <span class="string">&#x27;baidu.com&#x27;</span>&#125;&#125;)</span><br><span class="line">				],</span><br><span class="line">				actions: [<span class="keyword">new</span> chrome.declarativeContent.ShowPageAction()]</span><br><span class="line">			&#125;</span><br><span class="line">		]);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101633728-1835819108.gif" alt="img" loading="lazy"></p>
<h4 id="å³é”®èœå•"><a href="#å³é”®èœå•" class="headerlink" title="å³é”®èœå•"></a>å³é”®èœå•</h4><p>é€šè¿‡å¼€å‘Chromeæ’ä»¶å¯ä»¥è‡ªå®šä¹‰æµè§ˆå™¨çš„å³é”®èœå•ï¼Œä¸»è¦æ˜¯é€šè¿‡<code>chrome.contextMenus</code>APIå®ç°ï¼Œå³é”®èœå•å¯ä»¥å‡ºç°åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚æ™®é€šé¡µé¢ã€é€‰ä¸­çš„æ–‡å­—ã€å›¾ç‰‡ã€é“¾æ¥ï¼Œç­‰ç­‰ï¼Œå¦‚æœæœ‰åŒä¸€ä¸ªæ’ä»¶é‡Œé¢å®šä¹‰äº†å¤šä¸ªèœå•ï¼ŒChromeä¼šè‡ªåŠ¨ç»„åˆæ”¾åˆ°ä»¥æ’ä»¶åå­—å‘½åçš„äºŒçº§èœå•é‡Œï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101651618-268310284.png" alt="img" loading="lazy"></p>
<p>æœ€ç®€å•çš„å³é”®èœå•ç¤ºä¾‹:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// manifest.json</span></span><br><span class="line">&#123;<span class="string">&quot;permissions&quot;</span>: [<span class="string">&quot;contextMenus&quot;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// background.js</span></span><br><span class="line">chrome.contextMenus.create(&#123;</span><br><span class="line">	title: <span class="string">&quot;æµ‹è¯•å³é”®èœå•&quot;</span>,</span><br><span class="line">	onclick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="string">&#x27;æ‚¨ç‚¹å‡»äº†å³é”®èœå•ï¼&#x27;</span>);&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101704775-1000780193.png" alt="img" loading="lazy"></p>
<h4 id="override-è¦†ç›–ç‰¹å®šé¡µé¢"><a href="#override-è¦†ç›–ç‰¹å®šé¡µé¢" class="headerlink" title="override(è¦†ç›–ç‰¹å®šé¡µé¢)"></a>override(è¦†ç›–ç‰¹å®šé¡µé¢)</h4><p>ä½¿ç”¨<code>override</code>é¡µå¯ä»¥å°†Chromeé»˜è®¤çš„ä¸€äº›ç‰¹å®šé¡µé¢æ›¿æ¢æ‰ï¼Œæ”¹ä¸ºä½¿ç”¨æ‰©å±•æä¾›çš„é¡µé¢ã€‚</p>
<p>æ‰©å±•å¯ä»¥æ›¿ä»£å¦‚ä¸‹é¡µé¢ï¼š</p>
<ul>
<li>å†å²è®°å½•ï¼šä»å·¥å…·èœå•ä¸Šç‚¹å‡»å†å²è®°å½•æ—¶è®¿é—®çš„é¡µé¢ï¼Œæˆ–è€…ä»åœ°å€æ ç›´æ¥è¾“å…¥ chrome://history</li>
<li>æ–°æ ‡ç­¾é¡µï¼šå½“åˆ›å»ºæ–°æ ‡ç­¾çš„æ—¶å€™è®¿é—®çš„é¡µé¢ï¼Œæˆ–è€…ä»åœ°å€æ ç›´æ¥è¾“å…¥ chrome://newtab</li>
<li>ä¹¦ç­¾ï¼šæµè§ˆå™¨çš„ä¹¦ç­¾ï¼Œæˆ–è€…ç›´æ¥è¾“å…¥ chrome://bookmarks</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>ä¸€ä¸ªæ‰©å±•åªèƒ½æ›¿ä»£ä¸€ä¸ªé¡µé¢ï¼›</li>
<li>ä¸èƒ½æ›¿ä»£éšèº«çª—å£çš„æ–°æ ‡ç­¾é¡µï¼›</li>
<li>ç½‘é¡µå¿…é¡»è®¾ç½®titleï¼Œå¦åˆ™ç”¨æˆ·å¯èƒ½ä¼šçœ‹åˆ°ç½‘é¡µçš„URLï¼Œé€ æˆå›°æ‰°ï¼›</li>
</ul>
<p>ä»£ç ï¼ˆæ³¨æ„ï¼Œä¸€ä¸ªæ’ä»¶åªèƒ½æ›¿ä»£ä¸€ä¸ªé»˜è®¤é¡µï¼Œä»¥ä¸‹ä»…ä¸ºæ¼”ç¤ºï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;chrome_url_overrides&quot;</span>:</span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;newtab&quot;</span>: <span class="string">&quot;newtab.html&quot;</span>,</span><br><span class="line">	<span class="string">&quot;history&quot;</span>: <span class="string">&quot;history.html&quot;</span>,</span><br><span class="line">	<span class="string">&quot;bookmarks&quot;</span>: <span class="string">&quot;bookmarks.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="devtools-å¼€å‘è€…å·¥å…·"><a href="#devtools-å¼€å‘è€…å·¥å…·" class="headerlink" title="devtools(å¼€å‘è€…å·¥å…·)"></a>devtools(å¼€å‘è€…å·¥å…·)</h4><p>ä½¿ç”¨è¿‡vueçš„åº”è¯¥è§è¿‡è¿™ç§ç±»å‹çš„æ’ä»¶ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/352797/201707/352797-20170711101756868-1307680533.png" alt="img" loading="lazy"></p>
<p>æ˜¯çš„ï¼ŒChromeå…è®¸æ’ä»¶åœ¨å¼€å‘è€…å·¥å…·(devtools)ä¸ŠåŠ¨æ‰‹è„šï¼Œä¸»è¦è¡¨ç°åœ¨ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰ä¸€ä¸ªå’Œå¤šä¸ªå’Œ<code>Elements</code>ã€<code>Console</code>ã€<code>Sources</code>ç­‰åŒçº§åˆ«çš„é¢æ¿ï¼›</li>
<li>è‡ªå®šä¹‰ä¾§è¾¹æ (sidebar)ï¼Œç›®å‰åªèƒ½è‡ªå®šä¹‰<code>Elements</code>é¢æ¿çš„ä¾§è¾¹æ ï¼›</li>
</ul>
<p>æ¯æ‰“å¼€ä¸€ä¸ªå¼€å‘è€…å·¥å…·çª—å£ï¼Œéƒ½ä¼šåˆ›å»ºdevtoolsé¡µé¢çš„å®ä¾‹ï¼ŒF12çª—å£å…³é—­ï¼Œé¡µé¢ä¹Ÿéšç€å…³é—­ï¼Œæ‰€ä»¥devtoolsé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸå’Œdevtoolsçª—å£æ˜¯ä¸€è‡´çš„ã€‚devtoolsé¡µé¢å¯ä»¥è®¿é—®ä¸€ç»„ç‰¹æœ‰çš„<code>DevTools API</code>ä»¥åŠæœ‰é™çš„æ‰©å±•APIï¼Œè¿™ç»„ç‰¹æœ‰çš„<code>DevTools API</code>åªæœ‰devtoolsé¡µé¢æ‰å¯ä»¥è®¿é—®ï¼Œbackgroundéƒ½æ— æƒè®¿é—®ï¼Œè¿™äº›APIåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>chrome.devtools.panels</code>ï¼šé¢æ¿ç›¸å…³ï¼›</li>
<li><code>chrome.devtools.inspectedWindow</code>ï¼šè·å–è¢«å®¡æŸ¥çª—å£çš„æœ‰å…³ä¿¡æ¯ï¼›</li>
<li><code>chrome.devtools.network</code>ï¼šè·å–æœ‰å…³ç½‘ç»œè¯·æ±‚çš„ä¿¡æ¯ï¼›</li>
</ul>
<p>å¤§éƒ¨åˆ†æ‰©å±•APIéƒ½æ— æ³•ç›´æ¥è¢«<code>DevTools</code>é¡µé¢è°ƒç”¨ï¼Œä½†å®ƒå¯ä»¥åƒ<code>content-script</code>ä¸€æ ·ç›´æ¥è°ƒç”¨<code>chrome.extension</code>å’Œ<code>chrome.runtime</code>APIï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ä»¥åƒ<code>content-script</code>ä¸€æ ·ä½¿ç”¨Messageäº¤äº’çš„æ–¹å¼ä¸backgroundé¡µé¢è¿›è¡Œé€šä¿¡ã€‚</p>
<h4 id="option-é€‰é¡¹é¡µ"><a href="#option-é€‰é¡¹é¡µ" class="headerlink" title="option(é€‰é¡¹é¡µ)"></a>option(é€‰é¡¹é¡µ)</h4><p>æ‰€è°“<code>options</code>é¡µï¼Œå°±æ˜¯æ’ä»¶çš„è®¾ç½®é¡µé¢ï¼Œæœ‰2ä¸ªå…¥å£ï¼Œä¸€ä¸ªæ˜¯å³é”®å›¾æ ‡æœ‰ä¸€ä¸ªâ€œé€‰é¡¹â€èœå•ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ¨æ’ä»¶ç®¡ç†é¡µé¢ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185830.png" alt="img" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185836.png" alt="img" loading="lazy"></p>
<p>åœ¨Chrome40ä»¥å‰ï¼Œoptionsé¡µé¢å’Œå…¶å®ƒæ™®é€šé¡µé¢æ²¡ä»€ä¹ˆåŒºåˆ«ï¼ŒChrome40ä»¥ååˆ™æœ‰äº†ä¸€äº›å˜åŒ–ã€‚</p>
<p>æˆ‘ä»¬å…ˆçœ‹è€ç‰ˆçš„<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/options">options</a>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Chrome40ä»¥å‰çš„æ’ä»¶é…ç½®é¡µå†™æ³•</span></span><br><span class="line">	<span class="string">&quot;options_page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¡µé¢é‡Œé¢çš„å†…å®¹å°±éšä½ è‡ªå·±å‘æŒ¥äº†ï¼Œé…ç½®ä¹‹ååœ¨æ’ä»¶ç®¡ç†é¡µå°±ä¼šçœ‹åˆ°ä¸€ä¸ª<code>é€‰é¡¹</code>æŒ‰é’®å…¥å£ï¼Œç‚¹è¿›å»å°±æ˜¯æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œæ²¡å•¥å¥½è®²çš„ã€‚</p>
<p>æ•ˆæœ:</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185839.png" alt="img" loading="lazy"></p>
<p>å†æ¥çœ‹æ–°ç‰ˆçš„<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/optionsV2">optionsV2</a>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;options_ui&quot;</span>:</span><br><span class="line">	&#123;</span><br><span class="line">    	<span class="string">&quot;page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">		<span class="comment">// æ·»åŠ ä¸€äº›é»˜è®¤çš„æ ·å¼ï¼Œæ¨èä½¿ç”¨</span></span><br><span class="line">    	<span class="string">&quot;chrome_style&quot;</span>: <span class="literal">true</span></span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185842.png" alt="img" loading="lazy"></p>
<p>çœ‹èµ·æ¥æ˜¯ä¸æ˜¯é«˜å¤§ä¸Šäº†ï¼Ÿ</p>
<p>å‡ ç‚¹æ³¨æ„ï¼š</p>
<ul>
<li>ä¸ºäº†å…¼å®¹ï¼Œå»ºè®®2ç§éƒ½å†™ï¼Œå¦‚æœéƒ½å†™äº†ï¼ŒChrome40ä»¥åä¼šé»˜è®¤è¯»å–æ–°ç‰ˆçš„æ–¹å¼ï¼›</li>
<li>æ–°ç‰ˆoptionsä¸­ä¸èƒ½ä½¿ç”¨alertï¼›</li>
<li>æ•°æ®å­˜å‚¨å»ºè®®ç”¨chrome.storageï¼Œå› ä¸ºä¼šéšç”¨æˆ·è‡ªåŠ¨åŒæ­¥ï¼›</li>
</ul>
<h4 id="omnibox"><a href="#omnibox" class="headerlink" title="omnibox"></a>omnibox</h4><p><code>omnibox</code>æ˜¯å‘ç”¨æˆ·æä¾›æœç´¢å»ºè®®çš„ä¸€ç§æ–¹å¼ã€‚å…ˆæ¥çœ‹ä¸ª<code>gif</code>å›¾ä»¥ä¾¿äº†è§£ä¸€ä¸‹è¿™ä¸œè¥¿åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185846.gif" alt="img" loading="lazy"></p>
<p>æ³¨å†ŒæŸä¸ªå…³é”®å­—ä»¥è§¦å‘æ’ä»¶è‡ªå·±çš„æœç´¢å»ºè®®ç•Œé¢ï¼Œç„¶åå¯ä»¥ä»»æ„å‘æŒ¥äº†ã€‚</p>
<p>é¦–å…ˆï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="comment">// å‘åœ°å€æ æ³¨å†Œä¸€ä¸ªå…³é”®å­—ä»¥æä¾›æœç´¢å»ºè®®ï¼Œåªèƒ½è®¾ç½®ä¸€ä¸ªå…³é”®å­—</span></span><br><span class="line">	<span class="string">&quot;omnibox&quot;</span>: &#123; <span class="string">&quot;keyword&quot;</span> : <span class="string">&quot;go&quot;</span> &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶å<code>background.js</code>ä¸­æ³¨å†Œç›‘å¬äº‹ä»¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// omnibox æ¼”ç¤º</span></span><br><span class="line">chrome.omnibox.onInputChanged.addListener(<span class="function">(<span class="params">text, suggest</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;inputChanged: &#x27;</span> + text);</span><br><span class="line">	<span class="keyword">if</span>(!text) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(text == <span class="string">&#x27;ç¾å¥³&#x27;</span>) &#123;</span><br><span class="line">		suggest([</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;ä¸­å›½&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;ä½ è¦æ‰¾â€œä¸­å›½ç¾å¥³â€å—ï¼Ÿ&#x27;</span>&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;æ—¥æœ¬&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;ä½ è¦æ‰¾â€œæ—¥æœ¬ç¾å¥³â€å—ï¼Ÿ&#x27;</span>&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;æ³°å›½&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;ä½ è¦æ‰¾â€œæ³°å›½ç¾å¥³æˆ–äººå¦–â€å—ï¼Ÿ&#x27;</span>&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;éŸ©å›½&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;ä½ è¦æ‰¾â€œéŸ©å›½ç¾å¥³â€å—ï¼Ÿ&#x27;</span>&#125;</span><br><span class="line">		]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(text == <span class="string">&#x27;å¾®åš&#x27;</span>) &#123;</span><br><span class="line">		suggest([</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;æ–°æµª&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;æ–°æµª&#x27;</span> + text&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;è…¾è®¯&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;è…¾è®¯&#x27;</span> + text&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;æœç‹&#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;æœç´¢&#x27;</span> + text&#125;,</span><br><span class="line">		]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		suggest([</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;ç™¾åº¦æœç´¢ &#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;ç™¾åº¦æœç´¢ &#x27;</span> + text&#125;,</span><br><span class="line">			&#123;<span class="attr">content</span>: <span class="string">&#x27;è°·æ­Œæœç´¢ &#x27;</span> + text, <span class="attr">description</span>: <span class="string">&#x27;è°·æ­Œæœç´¢ &#x27;</span> + text&#125;,</span><br><span class="line">		]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ç”¨æˆ·æ¥æ”¶å…³é”®å­—å»ºè®®æ—¶è§¦å‘</span></span><br><span class="line">chrome.omnibox.onInputEntered.addListener(<span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;inputEntered: &#x27;</span> + text);</span><br><span class="line">	<span class="keyword">if</span>(!text) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">var</span> href = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(text.endsWith(<span class="string">&#x27;ç¾å¥³&#x27;</span>)) href = <span class="string">&#x27;http://image.baidu.com/search/index?tn=baiduimage&amp;ie=utf-8&amp;word=&#x27;</span> + text;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(text.startsWith(<span class="string">&#x27;ç™¾åº¦æœç´¢&#x27;</span>)) href = <span class="string">&#x27;https://www.baidu.com/s?ie=UTF-8&amp;wd=&#x27;</span> + text.replace(<span class="string">&#x27;ç™¾åº¦æœç´¢ &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(text.startsWith(<span class="string">&#x27;è°·æ­Œæœç´¢&#x27;</span>)) href = <span class="string">&#x27;https://www.google.com.tw/search?q=&#x27;</span> + text.replace(<span class="string">&#x27;è°·æ­Œæœç´¢ &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">	<span class="keyword">else</span> href = <span class="string">&#x27;https://www.baidu.com/s?ie=UTF-8&amp;wd=&#x27;</span> + text;</span><br><span class="line">	openUrlCurrentTab(href);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// è·å–å½“å‰é€‰é¡¹å¡ID</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTabId</span>(<span class="params">callback</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	chrome.tabs.query(&#123;<span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">tabs</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(callback) callback(tabs.length ? tabs[<span class="number">0</span>].id: <span class="literal">null</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰æ ‡ç­¾æ‰“å¼€æŸä¸ªé“¾æ¥</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openUrlCurrentTab</span>(<span class="params">url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	getCurrentTabId(<span class="function"><span class="params">tabId</span> =&gt;</span> &#123;</span><br><span class="line">		chrome.tabs.update(tabId, &#123;<span class="attr">url</span>: url&#125;);</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¡Œé¢é€šçŸ¥"><a href="#æ¡Œé¢é€šçŸ¥" class="headerlink" title="æ¡Œé¢é€šçŸ¥"></a>æ¡Œé¢é€šçŸ¥</h4><p>Chromeæä¾›äº†ä¸€ä¸ª<code>chrome.notifications</code>APIä»¥ä¾¿æ’ä»¶æ¨é€æ¡Œé¢é€šçŸ¥ï¼Œæš‚æœªæ‰¾åˆ°<code>chrome.notifications</code>å’ŒHTML5è‡ªå¸¦çš„<code>Notification</code>çš„æ˜¾è‘—åŒºåˆ«åŠä¼˜åŠ¿ã€‚</p>
<p>åœ¨åå°JSä¸­ï¼Œæ— è®ºæ˜¯ä½¿ç”¨<code>chrome.notifications</code>è¿˜æ˜¯<code>Notification</code>éƒ½ä¸éœ€è¦ç”³è¯·æƒé™ï¼ˆHTML5æ–¹å¼éœ€è¦ç”³è¯·æƒé™ï¼‰ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</p>
<p>æœ€ç®€å•çš„é€šçŸ¥ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185850.png" alt="img" loading="lazy"></p>
<p>ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chrome.notifications.create(<span class="literal">null</span>, &#123;</span><br><span class="line">	type: <span class="string">&#x27;basic&#x27;</span>,</span><br><span class="line">	iconUrl: <span class="string">&#x27;img/icon.png&#x27;</span>,</span><br><span class="line">	title: <span class="string">&#x27;è¿™æ˜¯æ ‡é¢˜&#x27;</span>,</span><br><span class="line">	message: <span class="string">&#x27;æ‚¨åˆšæ‰ç‚¹å‡»äº†è‡ªå®šä¹‰å³é”®èœå•ï¼&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="5ç§ç±»å‹çš„JSå¯¹æ¯”"><a href="#5ç§ç±»å‹çš„JSå¯¹æ¯”" class="headerlink" title="5ç§ç±»å‹çš„JSå¯¹æ¯”"></a>5ç§ç±»å‹çš„JSå¯¹æ¯”</h3><p>Chromeæ’ä»¶çš„JSä¸»è¦å¯ä»¥åˆ†ä¸ºè¿™5ç±»ï¼š<code>injected script</code>ã€<code>content-script</code>ã€<code>popup js</code>ã€<code>background js</code>å’Œ<code>devtools js</code></p>
<h4 id="æƒé™å¯¹æ¯”"><a href="#æƒé™å¯¹æ¯”" class="headerlink" title="æƒé™å¯¹æ¯”"></a>æƒé™å¯¹æ¯”</h4><table>
<thead>
<tr>
<th>JSç§ç±»</th>
<th>å¯è®¿é—®çš„API</th>
<th>DOMè®¿é—®æƒ…å†µ</th>
<th>JSè®¿é—®æƒ…å†µ</th>
<th>ç›´æ¥è·¨åŸŸ</th>
</tr>
</thead>
<tbody><tr>
<td>injected script</td>
<td>å’Œæ™®é€šJSæ— ä»»ä½•å·®åˆ«ï¼Œä¸èƒ½è®¿é—®ä»»ä½•æ‰©å±•API</td>
<td>å¯ä»¥è®¿é—®</td>
<td>å¯ä»¥è®¿é—®</td>
<td>ä¸å¯ä»¥</td>
</tr>
<tr>
<td>content script</td>
<td>åªèƒ½è®¿é—® extensionã€runtimeç­‰éƒ¨åˆ†API</td>
<td>å¯ä»¥è®¿é—®</td>
<td>ä¸å¯ä»¥</td>
<td>ä¸å¯ä»¥</td>
</tr>
<tr>
<td>popup js</td>
<td>å¯è®¿é—®ç»å¤§éƒ¨åˆ†APIï¼Œé™¤äº†devtoolsç³»åˆ—</td>
<td>ä¸å¯ç›´æ¥è®¿é—®</td>
<td>ä¸å¯ä»¥</td>
<td>å¯ä»¥</td>
</tr>
<tr>
<td>background js</td>
<td>å¯è®¿é—®ç»å¤§éƒ¨åˆ†APIï¼Œé™¤äº†devtoolsç³»åˆ—</td>
<td>ä¸å¯ç›´æ¥è®¿é—®</td>
<td>ä¸å¯ä»¥</td>
<td>å¯ä»¥</td>
</tr>
<tr>
<td>devtools js</td>
<td>åªèƒ½è®¿é—® devtoolsã€extensionã€runtimeç­‰éƒ¨åˆ†API</td>
<td>å¯ä»¥</td>
<td>å¯ä»¥</td>
<td>ä¸å¯ä»¥</td>
</tr>
</tbody></table>
<h4 id="è°ƒè¯•æ–¹å¼å¯¹æ¯”"><a href="#è°ƒè¯•æ–¹å¼å¯¹æ¯”" class="headerlink" title="è°ƒè¯•æ–¹å¼å¯¹æ¯”"></a>è°ƒè¯•æ–¹å¼å¯¹æ¯”</h4><table>
<thead>
<tr>
<th>JSç±»å‹</th>
<th>è°ƒè¯•æ–¹å¼</th>
<th>å›¾ç‰‡è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>injected script</td>
<td>ç›´æ¥æ™®é€šçš„F12å³å¯</td>
<td>æ‡’å¾—æˆªå›¾</td>
</tr>
<tr>
<td>content-script</td>
<td>æ‰“å¼€Console,å¦‚å›¾åˆ‡æ¢</td>
<td><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185855.png" alt="img" loading="lazy"></td>
</tr>
<tr>
<td>popup-js</td>
<td>popupé¡µé¢å³é”®å®¡æŸ¥å…ƒç´ </td>
<td><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185858.png" alt="img" loading="lazy"></td>
</tr>
<tr>
<td>background</td>
<td>æ’ä»¶ç®¡ç†é¡µç‚¹å‡»èƒŒæ™¯é¡µå³å¯</td>
<td><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185903.png" alt="img" loading="lazy"></td>
</tr>
<tr>
<td>devtools-js</td>
<td>æš‚æœªæ‰¾åˆ°æœ‰æ•ˆæ–¹æ³•</td>
<td>-</td>
</tr>
</tbody></table>
<h3 id="æ¶ˆæ¯é€šä¿¡"><a href="#æ¶ˆæ¯é€šä¿¡" class="headerlink" title="æ¶ˆæ¯é€šä¿¡"></a>æ¶ˆæ¯é€šä¿¡</h3><p>é€šä¿¡ä¸»é¡µï¼š<a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/messaging">https://developer.chrome.com/extensions/messaging</a></p>
<p>å‰é¢æˆ‘ä»¬ä»‹ç»äº†Chromeæ’ä»¶ä¸­å­˜åœ¨çš„5ç§JSï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¦‚ä½•äº’ç›¸é€šä¿¡å‘¢ï¼Ÿä¸‹é¢å…ˆæ¥ç³»ç»Ÿæ¦‚å†µä¸€ä¸‹ï¼Œç„¶åå†åˆ†ç±»ç»†è¯´ã€‚éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œpopupå’Œbackgroundå…¶å®å‡ ä¹å¯ä»¥è§†ä¸ºä¸€ç§ä¸œè¥¿ï¼Œå› ä¸ºå®ƒä»¬å¯è®¿é—®çš„APIéƒ½ä¸€æ ·ã€é€šä¿¡æœºåˆ¶ä¸€æ ·ã€éƒ½å¯ä»¥è·¨åŸŸã€‚</p>
<h4 id="äº’ç›¸é€šä¿¡æ¦‚è§ˆ"><a href="#äº’ç›¸é€šä¿¡æ¦‚è§ˆ" class="headerlink" title="äº’ç›¸é€šä¿¡æ¦‚è§ˆ"></a>äº’ç›¸é€šä¿¡æ¦‚è§ˆ</h4><p>æ³¨ï¼š<code>-</code>è¡¨ç¤ºä¸å­˜åœ¨æˆ–è€…æ— æ„ä¹‰ï¼Œæˆ–è€…å¾…éªŒè¯ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>injected-script</th>
<th>content-script</th>
<th>popup-js</th>
<th>background-js</th>
</tr>
</thead>
<tbody><tr>
<td>injected-script</td>
<td>-</td>
<td>window.postMessage</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>content-script</td>
<td>window.postMessage</td>
<td>-</td>
<td>chrome.runtime.sendMessage chrome.runtime.connect</td>
<td>chrome.runtime.sendMessage chrome.runtime.connect</td>
</tr>
<tr>
<td>popup-js</td>
<td>-</td>
<td>chrome.tabs.sendMessage chrome.tabs.connect</td>
<td>-</td>
<td>chrome.extension. getBackgroundPage()</td>
</tr>
<tr>
<td>background-js</td>
<td>-</td>
<td>chrome.tabs.sendMessage chrome.tabs.connect</td>
<td>chrome.extension.getViews</td>
<td>-</td>
</tr>
<tr>
<td>devtools-js</td>
<td>chrome.devtools. inspectedWindow.eval</td>
<td>-</td>
<td>chrome.runtime.sendMessage</td>
<td>chrome.runtime.sendMessage</td>
</tr>
</tbody></table>
<h4 id="é€šä¿¡è¯¦ç»†ä»‹ç»"><a href="#é€šä¿¡è¯¦ç»†ä»‹ç»" class="headerlink" title="é€šä¿¡è¯¦ç»†ä»‹ç»"></a>é€šä¿¡è¯¦ç»†ä»‹ç»</h4><h6 id="1-popupå’Œbackground"><a href="#1-popupå’Œbackground" class="headerlink" title="1. popupå’Œbackground"></a>1. popupå’Œbackground</h6><p>popupå¯ä»¥ç›´æ¥è°ƒç”¨backgroundä¸­çš„JSæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®backgroundçš„DOMï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// background.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	alert(<span class="string">&#x27;æˆ‘æ˜¯backgroundï¼&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// popup.js</span></span><br><span class="line"><span class="keyword">var</span> bg = chrome.extension.getBackgroundPage();</span><br><span class="line">bg.test(); <span class="comment">// è®¿é—®bgçš„å‡½æ•°</span></span><br><span class="line">alert(bg.document.body.innerHTML); <span class="comment">// è®¿é—®bgçš„DOM</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å°æ’æ›²ï¼Œä»Šå¤©ç¢°åˆ°ä¸€ä¸ªæƒ…å†µï¼Œå‘ç°popupæ— æ³•è·å–backgroundçš„ä»»ä½•æ–¹æ³•ï¼Œæ‰¾äº†åŠå¤©æ‰å‘ç°æ˜¯å› ä¸ºbackgroundçš„jsæŠ¥é”™äº†ï¼Œè€Œä½ å¦‚æœä¸ä¸»åŠ¨æŸ¥çœ‹backgroundçš„jsçš„è¯ï¼Œæ˜¯çœ‹ä¸åˆ°é”™è¯¯ä¿¡æ¯çš„ï¼Œç‰¹æ­¤æé†’ã€‚</p>
</blockquote>
<p>è‡³äº<code>background</code>è®¿é—®<code>popup</code>å¦‚ä¸‹ï¼ˆå‰ææ˜¯<code>popup</code>å·²ç»æ‰“å¼€ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> views = chrome.extension.getViews(&#123;<span class="attr">type</span>:<span class="string">&#x27;popup&#x27;</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(views.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(views[<span class="number">0</span>].location.href);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="2-popupæˆ–è€…bgå‘contentä¸»åŠ¨å‘é€æ¶ˆæ¯"><a href="#2-popupæˆ–è€…bgå‘contentä¸»åŠ¨å‘é€æ¶ˆæ¯" class="headerlink" title="2.popupæˆ–è€…bgå‘contentä¸»åŠ¨å‘é€æ¶ˆæ¯"></a>2.popupæˆ–è€…bgå‘contentä¸»åŠ¨å‘é€æ¶ˆæ¯</h6><p>background.jsæˆ–è€…popup.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendMessageToContentScript</span>(<span class="params">message, callback</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	chrome.tabs.query(&#123;<span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">tabs</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		chrome.tabs.sendMessage(tabs[<span class="number">0</span>].id, message, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(callback) callback(response);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line">sendMessageToContentScript(&#123;<span class="attr">cmd</span>:<span class="string">&#x27;test&#x27;</span>, <span class="attr">value</span>:<span class="string">&#x27;ä½ å¥½ï¼Œæˆ‘æ˜¯popupï¼&#x27;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;æ¥è‡ªcontentçš„å›å¤ï¼š&#x27;</span>+response);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>content-script.js</code>æ¥æ”¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">request, sender, sendResponse</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// console.log(sender.tab ?&quot;from a content script:&quot; + sender.tab.url :&quot;from the extension&quot;);</span></span><br><span class="line">	<span class="keyword">if</span>(request.cmd == <span class="string">&#x27;test&#x27;</span>) alert(request.value);</span><br><span class="line">	sendResponse(<span class="string">&#x27;æˆ‘æ”¶åˆ°äº†ä½ çš„æ¶ˆæ¯ï¼&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>åŒæ–¹é€šä¿¡ç›´æ¥å‘é€çš„éƒ½æ˜¯JSONå¯¹è±¡ï¼Œä¸æ˜¯JSONå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ— éœ€è§£æï¼Œå¾ˆæ–¹ä¾¿ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥å‘é€å­—ç¬¦ä¸²ï¼‰ã€‚</p>
<blockquote>
<p>ç½‘ä¸Šæœ‰äº›è€ä»£ç ä¸­ç”¨çš„æ˜¯<code>chrome.extension.onMessage</code>ï¼Œæ²¡æœ‰å®Œå…¨æŸ¥æ¸…äºŒè€…çš„åŒºåˆ«(è²Œä¼¼æ˜¯åˆ«å)ï¼Œä½†æ˜¯å»ºè®®ç»Ÿä¸€ä½¿ç”¨<code>chrome.runtime.onMessage</code>ã€‚</p>
</blockquote>
<h6 id="3-content-scriptä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°"><a href="#3-content-scriptä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°" class="headerlink" title="3. content-scriptä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°"></a>3. content-scriptä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°</h6><p>content-script.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chrome.runtime.sendMessage(&#123;<span class="attr">greeting</span>: <span class="string">&#x27;ä½ å¥½ï¼Œæˆ‘æ˜¯content-scriptå‘€ï¼Œæˆ‘ä¸»åŠ¨å‘æ¶ˆæ¯ç»™åå°ï¼&#x27;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;æ”¶åˆ°æ¥è‡ªåå°çš„å›å¤ï¼š&#x27;</span> + response);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>background.js æˆ–è€… popup.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬æ¥è‡ªcontent-scriptçš„æ¶ˆæ¯</span></span><br><span class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">request, sender, sendResponse</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;æ”¶åˆ°æ¥è‡ªcontent-scriptçš„æ¶ˆæ¯ï¼š&#x27;</span>);</span><br><span class="line">	<span class="built_in">console</span>.log(request, sender, sendResponse);</span><br><span class="line">	sendResponse(<span class="string">&#x27;æˆ‘æ˜¯åå°ï¼Œæˆ‘å·²æ”¶åˆ°ä½ çš„æ¶ˆæ¯ï¼š&#x27;</span> + <span class="built_in">JSON</span>.stringify(request));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>content_scriptså‘<code>popup</code>ä¸»åŠ¨å‘æ¶ˆæ¯çš„å‰ææ˜¯popupå¿…é¡»æ‰“å¼€ï¼å¦åˆ™éœ€è¦åˆ©ç”¨backgroundä½œä¸­è½¬ï¼›</li>
<li>å¦‚æœbackgroundå’ŒpopupåŒæ—¶ç›‘å¬ï¼Œé‚£ä¹ˆå®ƒä»¬éƒ½å¯ä»¥åŒæ—¶æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªå¯ä»¥sendResponseï¼Œä¸€ä¸ªå…ˆå‘é€äº†ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªå†å‘é€å°±æ— æ•ˆï¼›</li>
</ul>
<h6 id="4-injected-scriptå’Œcontent-script"><a href="#4-injected-scriptå’Œcontent-script" class="headerlink" title="4. injected scriptå’Œcontent-script"></a>4. injected scriptå’Œcontent-script</h6><p><code>content-script</code>å’Œé¡µé¢å†…çš„è„šæœ¬ï¼ˆ<code>injected-script</code>è‡ªç„¶ä¹Ÿå±äºé¡µé¢å†…çš„è„šæœ¬ï¼‰ä¹‹é—´å”¯ä¸€å…±äº«çš„ä¸œè¥¿å°±æ˜¯é¡µé¢çš„DOMå…ƒç´ ï¼Œæœ‰2ç§æ–¹æ³•å¯ä»¥å®ç°äºŒè€…é€šè®¯ï¼š</p>
<ol>
<li>å¯ä»¥é€šè¿‡<code>window.postMessage</code>å’Œ<code>window.addEventListener</code>æ¥å®ç°äºŒè€…æ¶ˆæ¯é€šè®¯ï¼›</li>
<li>é€šè¿‡è‡ªå®šä¹‰DOMäº‹ä»¶æ¥å®ç°ï¼›</li>
</ol>
<p>ç¬¬ä¸€ç§æ–¹æ³•ï¼ˆæ¨èï¼‰ï¼š</p>
<p><code>injected-script</code>ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.postMessage(&#123;<span class="string">&quot;test&quot;</span>: <span class="string">&#x27;ä½ å¥½ï¼&#x27;</span>&#125;, <span class="string">&#x27;*&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>content scriptä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;message&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(e.data);</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ–¹æ³•ï¼š</p>
<p><code>injected-script</code>ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> customEvent = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;Event&#x27;</span>);</span><br><span class="line">customEvent.initEvent(<span class="string">&#x27;myCustomEvent&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fireCustomEvent</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">	hiddenDiv = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myCustomEventDiv&#x27;</span>);</span><br><span class="line">	hiddenDiv.innerText = data</span><br><span class="line">	hiddenDiv.dispatchEvent(customEvent);</span><br><span class="line">&#125;</span><br><span class="line">fireCustomEvent(<span class="string">&#x27;ä½ å¥½ï¼Œæˆ‘æ˜¯æ™®é€šJSï¼&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><code>content-script.js</code>ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hiddenDiv = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myCustomEventDiv&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!hiddenDiv) &#123;</span><br><span class="line">	hiddenDiv = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">	hiddenDiv.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">	<span class="built_in">document</span>.body.appendChild(hiddenDiv);</span><br><span class="line">&#125;</span><br><span class="line">hiddenDiv.addEventListener(<span class="string">&#x27;myCustomEvent&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> eventData = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myCustomEventDiv&#x27;</span>).innerText;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;æ”¶åˆ°è‡ªå®šä¹‰äº‹ä»¶æ¶ˆæ¯ï¼š&#x27;</span> + eventData);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="é•¿è¿æ¥å’ŒçŸ­è¿æ¥"><a href="#é•¿è¿æ¥å’ŒçŸ­è¿æ¥" class="headerlink" title="é•¿è¿æ¥å’ŒçŸ­è¿æ¥"></a>é•¿è¿æ¥å’ŒçŸ­è¿æ¥</h4><p>å…¶å®ä¸Šé¢å·²ç»æ¶‰åŠåˆ°äº†ï¼Œè¿™é‡Œå†å•ç‹¬è¯´æ˜ä¸€ä¸‹ã€‚Chromeæ’ä»¶ä¸­æœ‰2ç§é€šä¿¡æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯çŸ­è¿æ¥ï¼ˆ<code>chrome.tabs.sendMessage</code>å’Œ<code>chrome.runtime.sendMessage</code>ï¼‰ï¼Œä¸€ä¸ªæ˜¯é•¿è¿æ¥ï¼ˆ<code>chrome.tabs.connect</code>å’Œ<code>chrome.runtime.connect</code>ï¼‰ã€‚</p>
<p>çŸ­è¿æ¥çš„è¯å°±æ˜¯æŒ¤ç‰™è†ä¸€æ ·ï¼Œæˆ‘å‘é€ä¸€ä¸‹ï¼Œä½ æ”¶åˆ°äº†å†å›å¤ä¸€ä¸‹ï¼Œå¦‚æœå¯¹æ–¹ä¸å›å¤ï¼Œä½ åªèƒ½é‡æ–°å‘ï¼Œè€Œé•¿è¿æ¥ç±»ä¼¼<code>WebSocket</code>ä¼šä¸€ç›´å»ºç«‹è¿æ¥ï¼ŒåŒæ–¹å¯ä»¥éšæ—¶äº’å‘æ¶ˆæ¯ã€‚</p>
<p>çŸ­è¿æ¥ä¸Šé¢å·²ç»æœ‰ä»£ç ç¤ºä¾‹äº†ï¼Œè¿™é‡Œåªè®²ä¸€ä¸‹é•¿è¿æ¥ã€‚</p>
<p>popup.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">getCurrentTabId(<span class="function">(<span class="params">tabId</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> port = chrome.tabs.connect(tabId, &#123;<span class="attr">name</span>: <span class="string">&#x27;test-connect&#x27;</span>&#125;);</span><br><span class="line">	port.postMessage(&#123;<span class="attr">question</span>: <span class="string">&#x27;ä½ æ˜¯è°å•Šï¼Ÿ&#x27;</span>&#125;);</span><br><span class="line">	port.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">		alert(<span class="string">&#x27;æ”¶åˆ°æ¶ˆæ¯ï¼š&#x27;</span>+msg.answer);</span><br><span class="line">		<span class="keyword">if</span>(msg.answer &amp;&amp; msg.answer.startsWith(<span class="string">&#x27;æˆ‘æ˜¯&#x27;</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			port.postMessage(&#123;<span class="attr">question</span>: <span class="string">&#x27;å“¦ï¼ŒåŸæ¥æ˜¯ä½ å•Šï¼&#x27;</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>content-script.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬é•¿è¿æ¥</span></span><br><span class="line">chrome.runtime.onConnect.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">port</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(port);</span><br><span class="line">	<span class="keyword">if</span>(port.name == <span class="string">&#x27;test-connect&#x27;</span>) &#123;</span><br><span class="line">		port.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">&#x27;æ”¶åˆ°é•¿è¿æ¥æ¶ˆæ¯ï¼š&#x27;</span>, msg);</span><br><span class="line">			<span class="keyword">if</span>(msg.question == <span class="string">&#x27;ä½ æ˜¯è°å•Šï¼Ÿ&#x27;</span>) port.postMessage(&#123;<span class="attr">answer</span>: <span class="string">&#x27;æˆ‘æ˜¯ä½ çˆ¸ï¼&#x27;</span>&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å…¶å®ƒè¡¥å……"><a href="#å…¶å®ƒè¡¥å……" class="headerlink" title="å…¶å®ƒè¡¥å……"></a>å…¶å®ƒè¡¥å……</h3><h4 id="åŠ¨æ€æ³¨å…¥æˆ–æ‰§è¡ŒJS"><a href="#åŠ¨æ€æ³¨å…¥æˆ–æ‰§è¡ŒJS" class="headerlink" title="åŠ¨æ€æ³¨å…¥æˆ–æ‰§è¡ŒJS"></a>åŠ¨æ€æ³¨å…¥æˆ–æ‰§è¡ŒJS</h4><p>è™½ç„¶åœ¨<code>background</code>å’Œ<code>popup</code>ä¸­æ— æ³•ç›´æ¥è®¿é—®é¡µé¢DOMï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡<code>chrome.tabs.executeScript</code>æ¥æ‰§è¡Œè„šæœ¬ï¼Œä»è€Œå®ç°è®¿é—®webé¡µé¢çš„DOMï¼ˆæ³¨æ„ï¼Œè¿™ç§æ–¹å¼ä¹Ÿä¸èƒ½ç›´æ¥è®¿é—®é¡µé¢JSï¼‰ã€‚</p>
<p>ç¤ºä¾‹<code>manifest.json</code>é…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;åŠ¨æ€JSæ³¨å…¥æ¼”ç¤º&quot;</span>,</span><br><span class="line">	...</span><br><span class="line">	<span class="string">&quot;permissions&quot;</span>: [</span><br><span class="line">		<span class="string">&quot;tabs&quot;</span>, <span class="string">&quot;http://*/*&quot;</span>, <span class="string">&quot;https://*/*&quot;</span></span><br><span class="line">	],</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JSï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ¨æ€æ‰§è¡ŒJSä»£ç </span></span><br><span class="line">chrome.tabs.executeScript(tabId, &#123;<span class="attr">code</span>: <span class="string">&#x27;document.body.style.backgroundColor=&quot;red&quot;&#x27;</span>&#125;);</span><br><span class="line"><span class="comment">// åŠ¨æ€æ‰§è¡ŒJSæ–‡ä»¶</span></span><br><span class="line">chrome.tabs.executeScript(tabId, &#123;<span class="attr">file</span>: <span class="string">&#x27;some-script.js&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="åŠ¨æ€æ³¨å…¥CSS"><a href="#åŠ¨æ€æ³¨å…¥CSS" class="headerlink" title="åŠ¨æ€æ³¨å…¥CSS"></a>åŠ¨æ€æ³¨å…¥CSS</h4><p>ç¤ºä¾‹<code>manifest.json</code>é…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;åŠ¨æ€CSSæ³¨å…¥æ¼”ç¤º&quot;</span>,</span><br><span class="line">	...</span><br><span class="line">	<span class="string">&quot;permissions&quot;</span>: [</span><br><span class="line">		<span class="string">&quot;tabs&quot;</span>, <span class="string">&quot;http://*/*&quot;</span>, <span class="string">&quot;https://*/*&quot;</span></span><br><span class="line">	],</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JSä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ¨æ€æ‰§è¡ŒCSSä»£ç ï¼ŒTODOï¼Œè¿™é‡Œæœ‰å¾…éªŒè¯</span></span><br><span class="line">chrome.tabs.insertCSS(tabId, &#123;<span class="attr">code</span>: <span class="string">&#x27;xxx&#x27;</span>&#125;);</span><br><span class="line"><span class="comment">// åŠ¨æ€æ‰§è¡ŒCSSæ–‡ä»¶</span></span><br><span class="line">chrome.tabs.insertCSS(tabId, &#123;<span class="attr">file</span>: <span class="string">&#x27;some-style.css&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="è·å–å½“å‰çª—å£ID"><a href="#è·å–å½“å‰çª—å£ID" class="headerlink" title="è·å–å½“å‰çª—å£ID"></a>è·å–å½“å‰çª—å£ID</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chrome.windows.getCurrent(<span class="function"><span class="keyword">function</span>(<span class="params">currentWindow</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;å½“å‰çª—å£IDï¼š&#x27;</span> + currentWindow.id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="è·å–å½“å‰æ ‡ç­¾é¡µID"><a href="#è·å–å½“å‰æ ‡ç­¾é¡µID" class="headerlink" title="è·å–å½“å‰æ ‡ç­¾é¡µID"></a>è·å–å½“å‰æ ‡ç­¾é¡µID</h4><p>ä¸€èˆ¬æœ‰2ç§æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å½“å‰é€‰é¡¹å¡ID</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTabId</span>(<span class="params">callback</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	chrome.tabs.query(&#123;<span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">tabs</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(callback) callback(tabs.length ? tabs[<span class="number">0</span>].id: <span class="literal">null</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è·å–å½“å‰é€‰é¡¹å¡idçš„å¦ä¸€ç§æ–¹æ³•ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éƒ½ç±»ä¼¼ï¼Œåªæœ‰å°‘éƒ¨åˆ†æ—¶å€™ä¼šä¸ä¸€æ ·ï¼ˆä¾‹å¦‚å½“çª—å£æœ€å°åŒ–æ—¶ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å½“å‰é€‰é¡¹å¡ID</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTabId2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	chrome.windows.getCurrent(<span class="function"><span class="keyword">function</span>(<span class="params">currentWindow</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		chrome.tabs.query(&#123;<span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">windowId</span>: currentWindow.id&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">tabs</span>)</span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(callback) callback(tabs.length ? tabs[<span class="number">0</span>].id: <span class="literal">null</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æœ¬åœ°å­˜å‚¨"><a href="#æœ¬åœ°å­˜å‚¨" class="headerlink" title="æœ¬åœ°å­˜å‚¨"></a>æœ¬åœ°å­˜å‚¨</h4><p>æœ¬åœ°å­˜å‚¨å»ºè®®ç”¨<code>chrome.storage</code>è€Œä¸æ˜¯æ™®é€šçš„<code>localStorage</code>ï¼ŒåŒºåˆ«æœ‰å¥½å‡ ç‚¹ï¼Œä¸ªäººè®¤ä¸ºæœ€é‡è¦çš„2ç‚¹åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><code>chrome.storage</code>æ˜¯é’ˆå¯¹æ’ä»¶å…¨å±€çš„ï¼Œå³ä½¿ä½ åœ¨<code>background</code>ä¸­ä¿å­˜çš„æ•°æ®ï¼Œåœ¨<code>content-script</code>ä¹Ÿèƒ½è·å–åˆ°ï¼›</li>
<li><code>chrome.storage.sync</code>å¯ä»¥è·Ÿéšå½“å‰ç™»å½•ç”¨æˆ·è‡ªåŠ¨åŒæ­¥ï¼Œè¿™å°ç”µè„‘ä¿®æ”¹çš„è®¾ç½®ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å…¶å®ƒç”µè„‘ï¼Œå¾ˆæ–¹ä¾¿ï¼Œå¦‚æœæ²¡æœ‰ç™»å½•æˆ–è€…æœªè”ç½‘åˆ™å…ˆä¿å­˜åˆ°æœ¬åœ°ï¼Œç­‰ç™»å½•äº†å†åŒæ­¥è‡³ç½‘ç»œï¼›</li>
</ul>
<p>éœ€è¦å£°æ˜<code>storage</code>æƒé™ï¼Œæœ‰<code>chrome.storage.sync</code>å’Œ<code>chrome.storage.local</code>2ç§æ–¹å¼å¯ä¾›é€‰æ‹©ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯»å–æ•°æ®ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŒ‡å®šè¦è¯»å–çš„keyä»¥åŠè®¾ç½®é»˜è®¤å€¼</span></span><br><span class="line">chrome.storage.sync.get(&#123;<span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(items.color, items.age);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ä¿å­˜æ•°æ®</span></span><br><span class="line">chrome.storage.sync.set(&#123;<span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;ä¿å­˜æˆåŠŸï¼&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="webRequest"><a href="#webRequest" class="headerlink" title="webRequest"></a>webRequest</h4><p>é€šè¿‡webRequestç³»åˆ—APIå¯ä»¥å¯¹HTTPè¯·æ±‚è¿›è¡Œä»»æ€§åœ°ä¿®æ”¹ã€å®šåˆ¶ï¼Œè¿™é‡Œé€šè¿‡<code>beforeRequest</code>æ¥ç®€å•æ¼”ç¤ºä¸€ä¸‹å®ƒçš„å†°å±±ä¸€è§’ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//manifest.json</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// æƒé™ç”³è¯·</span></span><br><span class="line">	<span class="string">&quot;permissions&quot;</span>:</span><br><span class="line">	[</span><br><span class="line">		<span class="string">&quot;webRequest&quot;</span>, <span class="comment">// webè¯·æ±‚</span></span><br><span class="line">		<span class="string">&quot;webRequestBlocking&quot;</span>, <span class="comment">// é˜»å¡å¼webè¯·æ±‚</span></span><br><span class="line">		<span class="string">&quot;storage&quot;</span>, <span class="comment">// æ’ä»¶æœ¬åœ°å­˜å‚¨</span></span><br><span class="line">		<span class="string">&quot;http://*/*&quot;</span>, <span class="comment">// å¯ä»¥é€šè¿‡executeScriptæˆ–è€…insertCSSè®¿é—®çš„ç½‘ç«™</span></span><br><span class="line">		<span class="string">&quot;https://*/*&quot;</span> <span class="comment">// å¯ä»¥é€šè¿‡executeScriptæˆ–è€…insertCSSè®¿é—®çš„ç½‘ç«™</span></span><br><span class="line">	],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// background.js</span></span><br><span class="line"><span class="comment">// æ˜¯å¦æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line"><span class="keyword">var</span> showImage;</span><br><span class="line">chrome.storage.sync.get(&#123;<span class="attr">showImage</span>: <span class="literal">true</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line">	showImage = items.showImage;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// webè¯·æ±‚ç›‘å¬ï¼Œæœ€åä¸€ä¸ªå‚æ•°è¡¨ç¤ºé˜»å¡å¼ï¼Œéœ€å•ç‹¬å£°æ˜æƒé™ï¼šwebRequestBlocking</span></span><br><span class="line">chrome.webRequest.onBeforeRequest.addListener(<span class="function"><span class="params">details</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// cancel è¡¨ç¤ºå–æ¶ˆæœ¬æ¬¡è¯·æ±‚</span></span><br><span class="line">	<span class="keyword">if</span>(!showImage &amp;&amp; details.type == <span class="string">&#x27;image&#x27;</span>) <span class="keyword">return</span> &#123;<span class="attr">cancel</span>: <span class="literal">true</span>&#125;;</span><br><span class="line">	<span class="comment">// ç®€å•çš„éŸ³è§†é¢‘æ£€æµ‹</span></span><br><span class="line">	<span class="comment">// å¤§éƒ¨åˆ†ç½‘ç«™è§†é¢‘çš„typeå¹¶ä¸æ˜¯mediaï¼Œä¸”è§†é¢‘åšäº†é˜²ä¸‹è½½å¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæ— å®é™…æ„ä¹‰</span></span><br><span class="line">	<span class="keyword">if</span>(details.type == <span class="string">&#x27;media&#x27;</span>) &#123;</span><br><span class="line">		chrome.notifications.create(<span class="literal">null</span>, &#123;</span><br><span class="line">			type: <span class="string">&#x27;basic&#x27;</span>,</span><br><span class="line">			iconUrl: <span class="string">&#x27;img/icon.png&#x27;</span>,</span><br><span class="line">			title: <span class="string">&#x27;æ£€æµ‹åˆ°éŸ³è§†é¢‘&#x27;</span>,</span><br><span class="line">			message: <span class="string">&#x27;éŸ³è§†é¢‘åœ°å€ï¼š&#x27;</span> + details.url,</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;, &#123;<span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>]&#125;, [<span class="string">&quot;blocking&quot;</span>]);</span><br></pre></td></tr></table></figure>
<h4 id="APIæ€»ç»“"><a href="#APIæ€»ç»“" class="headerlink" title="APIæ€»ç»“"></a>APIæ€»ç»“</h4><p>æ¯”è¾ƒå¸¸ç”¨ç”¨çš„ä¸€äº›APIç³»åˆ—ï¼š</p>
<ul>
<li>chrome.tabs</li>
<li>chrome.runtime</li>
<li>chrome.webRequest</li>
<li>chrome.window</li>
<li>chrome.storage</li>
<li>chrome.contextMenus</li>
<li>chrome.devtools</li>
<li>chrome.extension</li>
</ul>
<h1 id="é¡¹ç›®å®æˆ˜"><a href="#é¡¹ç›®å®æˆ˜" class="headerlink" title="é¡¹ç›®å®æˆ˜"></a>é¡¹ç›®å®æˆ˜</h1><p>ä½¿ç”¨ vue cli 4 å¼€å‘ chrome æ’ä»¶</p>
<h3 id="åˆ›å»º-vue-cli-4-é¡¹ç›®"><a href="#åˆ›å»º-vue-cli-4-é¡¹ç›®" class="headerlink" title="åˆ›å»º vue cli 4 é¡¹ç›®"></a>åˆ›å»º vue cli 4 é¡¹ç›®</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create google-extension-demo</span><br></pre></td></tr></table></figure>
<p>å‹¾é€‰ <code>Babel</code>ã€<code>TypeScript</code>ã€<code>CSS Pre-processors</code>ã€<code>Linter / Formatter</code></p>
<p>è¿™é‡Œï¼ŒCSS é¢„å¤„ç†å™¨éšæ„ï¼Œæˆ‘é€‰äº†<code> Sass/SCSS (with dart-sass)</code>ã€‚</p>
<p>å¦å¤–ï¼Œ<code>linter / formatter</code> ä¸­çš„<code>TSLint</code>å·²ç»ä¸å†ç»´æŠ¤ï¼Œå»ºè®®ä½¿ç”¨<code>ESLint</code>+ <code>Prettier</code>ã€‚<br>ä¸è¦ä½¿ç”¨ <code>class-style component syntax</code>ï¼Œè§<a target="_blank" rel="noopener" href="https://github.com/superoo7/vue-cli-plugin-chrome-ext">vue-cli-plugin-chrome-ext</a>ã€‚</p>
<h3 id="æ·»åŠ -chrome-ext-æ’ä»¶"><a href="#æ·»åŠ -chrome-ext-æ’ä»¶" class="headerlink" title="æ·»åŠ  chrome-ext æ’ä»¶"></a>æ·»åŠ  chrome-ext æ’ä»¶</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue add chrome-ext</span><br></pre></td></tr></table></figure>
<p>è®°å¾—è¿™é‡Œå‹¾é€‰ ts:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">? Name of the Chrome Extension? todolist</span><br><span class="line">? Description <span class="keyword">for</span> the Chrome Extension? chrome extension</span><br><span class="line">? Version <span class="keyword">for</span> the Chrome Extension? 0.0.1</span><br><span class="line">? javascript or typescript? </span><br><span class="line">  js </span><br><span class="line">â¯ ts </span><br></pre></td></tr></table></figure>
<p>å‡ºç°äº†ä¸€ä¸ªé”™è¯¯:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â ‹  Running completion hooks...error: Require statement not part of import statement (@typescript-eslint/no-var-requires) at vue.config.js:1:27:</span><br><span class="line">&gt; 1 | const CopyWebpackPlugin = require(<span class="string">&quot;copy-webpack-plugin&quot;</span>);</span><br><span class="line">    |                           ^</span><br><span class="line">  2 | const path = require(<span class="string">&quot;path&quot;</span>);</span><br><span class="line">  3 | </span><br><span class="line">  4 | // Generate pages object</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸º <code>eslint</code> ä¸å…è®¸ <code>commonjs</code> çš„è¯­æ³•ï¼Œè€ƒè™‘åˆ° <code>vue.config.js</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠå®ƒæ”¾åˆ° <code>.eslintignore</code> æ–‡ä»¶ä¸­ï¼Œè®© <code>eslint</code> å¿½ç•¥ å®ƒã€‚</p>
<p>åœ¨ <code>.eslintignore</code> ä¸­å†™å…¥:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue.config.js</span><br></pre></td></tr></table></figure>
<p>`vue-cli-plugin-chrome-ext`` åˆ›å»ºä¸æ˜¯ SPA åº”ç”¨ï¼Œchrome æ’ä»¶æœ‰å¾ˆå¤šç•Œé¢ï¼Œæ‰€ä»¥æ˜¯æ¯ä¸€ä¸ªç•Œé¢åˆ†åˆ«ç¼–è¯‘ã€‚</p>
<p>æ¯”å¦‚ï¼Œsrc/popupæ˜¯ä¸€ä¸ªç•Œé¢ï¼Œsrc/optionsä¹Ÿæ˜¯ä¸€ä¸ªç•Œé¢ã€‚</p>
<p>è¿™æ ·ï¼ŒåŸå…ˆå¾ˆå¤šæ–‡ä»¶éƒ½æ²¡ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬åˆ æ‰ï¼Œåˆ†åˆ«æ˜¯ <code>src/main.ts</code>ã€<code>src/App.vue</code>ã€‚</p>
<h3 id="çƒ­é‡è½½å¼€å‘"><a href="#çƒ­é‡è½½å¼€å‘" class="headerlink" title="çƒ­é‡è½½å¼€å‘"></a>çƒ­é‡è½½å¼€å‘</h3><p>ä½¿ç”¨<code> npm run build-watch</code> å¯ä»¥ä½¿ç”¨çƒ­é‡è½½çš„æ–¹å¼è¿›è¡Œå¼€å‘ã€‚</p>
<p>è¿è¡Œåä¼šç”Ÿæˆä¸€ä¸ª dist æ–‡ä»¶å¤¹ï¼Œæ¯æ¬¡ä½ æ›´æ”¹ä»£ç éƒ½ä¼šé‡æ–°ç¼–è¯‘å’ŒåŠ è½½ä¸€æ¬¡ã€‚</p>
<p>å°† dist å¯¼å…¥åˆ° chrome æ’ä»¶ä¸­<br>è¿›å…¥ <code>chrome://extensions/</code>ï¼Œé€‰æ‹©å’ŒåŠ è½½ dist æ–‡ä»¶å¤¹è¿›æ¥ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185914.png" alt="image-20210921181313389" loading="lazy"></p>
<p>åŠ è½½æˆåŠŸä¹‹åï¼Œè®°å¾—å»å³ä¸Šè§’ç®¡ç†ç•Œé¢å¼€å¯ popup ç•Œé¢ ( æ–°ç‰ˆæœ¬ chrome )ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185920.png" alt="image-20210921181416179" loading="lazy"></p>
<p>ç°åœ¨ï¼Œä»£ç æ‰“å®Œä¹‹åå°±èƒ½ç«‹é©¬åœ¨ chrome çš„ popup è§†å›¾é‡Œçœ‹åˆ°æ¸²æŸ“ç»“æœã€‚</p>
<h3 id="ä½¿ç”¨-UI-ç»„ä»¶"><a href="#ä½¿ç”¨-UI-ç»„ä»¶" class="headerlink" title="ä½¿ç”¨ UI ç»„ä»¶"></a>ä½¿ç”¨ UI ç»„ä»¶</h3><p>è™½ç„¶ vue æ˜¯è·‘èµ·æ¥äº†ï¼Œä½†æ˜¯å¦‚æœä¸èƒ½å¯¼å…¥ç»„ä»¶ï¼Œé‚£ä¹Ÿæ²¡ç”¨ã€‚</p>
<p>ä»¥ <code>ant design vue</code> ä¸ºä¾‹ï¼Œæˆ‘é—¨æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save ant-design-vue</span><br></pre></td></tr></table></figure>
<p>åœ¨ popup ç•Œé¢å¯¼å…¥</p>
<p>åœ¨ <code>src/popup/index.ts</code> ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Antd <span class="keyword">from</span> <span class="string">&#x27;ant-design-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;ant-design-vue/dist/antd.css&#x27;</span>;</span><br><span class="line">Vue.use(Antd);</span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œsrcæ–‡ä»¶å¤¹ä¸‹é¢çš„æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä»£è¡¨äº†ä¸€ä¸ªé¡µé¢ï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰å¯¹åº”çš„ index.ts(ç›¸å½“äºmain.js)ã€index.htmlã€App.vueã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¦‚æœè¦ä½¿ç”¨UIåº“ï¼Œä¸æ˜¯åœ¨ä¸€ä¸ªå…¨å±€çš„ main.js é‡Œé¢é…ç½®ä¸€éå°±å¥½äº†ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸€ä¸ªé¡µé¢çš„æ–‡ä»¶å¤¹ä¸‹çš„ index.ts ä¸­éƒ½å¯¼å…¥ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä»…åœ¨ popup ç•Œé¢ä¸‹å¯¼å…¥äº†ï¼Œå¦‚æœä½ éœ€è¦åœ¨ options ç•Œé¢ä¸­ä¹Ÿä½¿ç”¨ï¼Œåˆ™éœ€è¦å» src/options/index.ts ä¸‹é¢ä¸€æ ·å¯¼å…¥ä¸€éã€‚</p>
<h3 id="ç¼–å†™ä¸€ä¸ªç®€å•çš„-popup-ç•Œé¢"><a href="#ç¼–å†™ä¸€ä¸ªç®€å•çš„-popup-ç•Œé¢" class="headerlink" title="ç¼–å†™ä¸€ä¸ªç®€å•çš„ popup ç•Œé¢"></a>ç¼–å†™ä¸€ä¸ªç®€å•çš„ popup ç•Œé¢</h3><p>ä½¿ç”¨ <code>ant design</code> çš„ <code>card</code> ç»„ä»¶æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œæ˜¯å¦å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>ç•Œé¢çš„ä¸»è¦ä»£ç ï¼Œåº”è¯¥å†™åœ¨ <code>App/App.vue</code> ç›®å½•ä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;main_app&quot;&gt;</span><br><span class="line">    &lt;a-card title&#x3D;&quot;ghost wang&quot;&gt;</span><br><span class="line">      coding</span><br><span class="line">    &lt;&#x2F;a-card&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;app&quot;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.main_app &#123;</span><br><span class="line">  font-family: &quot;Avenir&quot;, Helvetica, Arial, sans-serif;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">  text-align: center;</span><br><span class="line">  color: #2c3e50;</span><br><span class="line">  height: 500px;</span><br><span class="line">  width: 300px;</span><br><span class="line">  padding: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ•ˆæœå¤§æ¦‚è¿™æ ·å­:</p>
<p><img src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210921185920.png" alt="image-20210921181907717" loading="lazy"></p>
<h3 id="æ›´å¤šå¥½ç©çš„å¾…å‘ç°â€¦"><a href="#æ›´å¤šå¥½ç©çš„å¾…å‘ç°â€¦" class="headerlink" title="æ›´å¤šå¥½ç©çš„å¾…å‘ç°â€¦"></a>æ›´å¤šå¥½ç©çš„å¾…å‘ç°â€¦</h3></div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">æˆ‘å¾ˆå¯çˆ±ï¼Œè¯·ç»™æˆ‘é’±</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143747.jpeg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143747.jpeg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143944.jpeg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143944.jpeg" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143746.jpeg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/cong1223/cloudimg@master/img/20210131143746.jpeg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å°èªå¿™</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://cong1223.github.io/2021/09/22/Chrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/" title="Chromeæ’ä»¶å¼€å‘æ•™ç¨‹">https://cong1223.github.io/2021/09/22/Chrome%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/10/23/javascript%E5%85%B3%E4%BA%8EtoFixed%E7%9A%84%E8%AE%A1%E7%AE%97%E8%A7%84%E5%88%99/" rel="prev" title="javascriptå…³äºtoFixedçš„è®¡ç®—è§„åˆ™"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">javascriptå…³äºtoFixedçš„è®¡ç®—è§„åˆ™</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/08/28/%E3%80%90%E6%89%8B%E5%86%99%E9%A2%98%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%89%B9%E9%87%8F%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0/" rel="next" title="ã€æ‰‹å†™é¢˜ã€‘å®ç°ä¸€ä¸ªæ‰¹é‡è¯·æ±‚å‡½æ•° multiRequest(urls, maxNum)"><span class="post-nav-text">ã€æ‰‹å†™é¢˜ã€‘å®ç°ä¸€ä¸ªæ‰¹é‡è¯·æ±‚å‡½æ•° multiRequest(urls, maxNum)</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>ç‚¹å‡»æŒ‰é’®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/cong1223/cong1223.github.io/issues?q=is:issue+Chromeæ’ä»¶å¼€å‘æ•™ç¨‹">GitHub Issues</a><a class="hty-button hty-button--raised" id="github-discussions" target="_blank" rel="noopener" href="https://github.com/cong1223/cong1223.github.io/discussions/new">GitHub Discussions</a></div><div id="disqus_thread"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqusjs.css"><script src="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqus.js"></script><script>const disqusjsConfig = {"enable":true,"shortname":"ghostwang-com"}
function loadDisqus() {
  const dsqjs = new DisqusJS(disqusjsConfig)
}</script><script src="/js/comments/disqus.js"></script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡17038157å·</a></div><div class="copyright"><span>&copy; 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> å°èªå¿™</span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div></div></body></html>